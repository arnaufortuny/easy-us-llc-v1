import{_ as le}from"./pdf-DU6qdRYg.js";import{a as y,j as o,am as de,l as H,c as z,B as V,U as me,y as ge,ao as ce,a0 as pe,an as xe}from"./react-core-BwXmAyYw.js";import{B as w,q as fe,s as ue,t as he,v as Ae,y as C,N as be,o as je,I}from"./ui-components-CnPFRHmO.js";import{u as Ne,b as Ce,N as ve,L as Fe,F as Te,a as Se,l as ye}from"./index-BnUt9mq7.js";import{u as we,a as Le,b as De}from"./tanstack-Bcy__teF.js";import{u as Pe}from"./i18n-DfkNketv.js";import"./radix-ui-BLFq0uWR.js";import"./react-dom-lwpWoMhj.js";import"./forms-CNlQlKiB.js";function We(){const[,$]=Ne(),{t,i18n:M}=Pe(),{user:Q,isAuthenticated:E,isLoading:K}=Ce(),[R,J]=y.useState(""),[O,_]=y.useState(!1),[u,j]=y.useState({memberAddress:"",memberPhone:"",capitalContribution:"",effectiveDate:new Date().toISOString().split("T")[0]}),X=we(),{data:v,isLoading:Y}=Le({queryKey:["/api/user/completed-llcs"],enabled:E}),Z=De({mutationFn:async i=>Se("POST","/api/user/operating-agreements",i),onSuccess:()=>{X.invalidateQueries({queryKey:["/api/user/documents"]})}}),a=v?.find(i=>String(i.id)===R),ee=v&&v.length>0;if(y.useEffect(()=>{if(a){const i=`${a.ownerAddress}, ${a.ownerCity}, ${a.ownerProvince}, ${a.ownerCountry} ${a.ownerPostalCode}`;j(e=>({...e,memberAddress:i,memberPhone:a.ownerPhone||""}))}},[a]),K)return o.jsx("div",{className:"min-h-screen bg-background"});if(!E||!Q)return o.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center px-4",children:o.jsxs("div",{className:"text-center max-w-sm",children:[o.jsx("h2",{className:"text-xl font-bold text-foreground mb-2",children:t("tools.operatingAgreement.loginRequired")}),o.jsx("p",{className:"text-muted-foreground text-sm mb-4",children:t("tools.operatingAgreement.loginDescription")}),o.jsx(w,{onClick:()=>$("/auth/login"),className:"bg-accent text-accent-foreground rounded-full px-6",children:t("auth.login.submit")})]})});const q=i=>{if(!i)return"";const e=new Date(i),g=M.language==="es"?"es-ES":"en-US";return e.toLocaleDateString(g,{day:"2-digit",month:"long",year:"numeric"})},L=u.memberAddress.trim()!==""&&u.effectiveDate!=="",te=async()=>{if(!(!a||!a.ein||!L)){_(!0);try{const{default:i}=await le(async()=>{const{default:f}=await import("./pdf-DU6qdRYg.js").then(A=>A.j);return{default:f}},[]),e=new i,g=e.internal.pageSize.getWidth(),F=e.internal.pageSize.getHeight(),s=25,x=g-s*2,m=[110,220,138],l=[14,18,21],r=[107,114,128],b=[229,231,235],T=`${a.companyName} ${a.designator||"LLC"}`;let S=1;const D=()=>{e.setFillColor(248,250,252),e.rect(0,F-20,g,20,"F"),e.setFontSize(8),e.setTextColor(r[0],r[1],r[2]),e.text(t("tools.operatingAgreement.pdf.footer1"),s,F-10),e.text(`${t("tools.operatingAgreement.pdf.page")} ${S}`,g-s,F-10,{align:"right"})},P=()=>{e.setFillColor(m[0],m[1],m[2]),e.rect(0,0,g,4,"F"),e.setFontSize(8),e.setTextColor(r[0],r[1],r[2]),e.text(T,s,12),e.text(t("tools.operatingAgreement.pdf.title"),g-s,12,{align:"right"}),e.setDrawColor(b[0],b[1],b[2]),e.setLineWidth(.3),e.line(s,16,g-s,16)},N=f=>n+f>F-30?(D(),e.addPage(),S++,P(),25):n;e.setFillColor(m[0],m[1],m[2]),e.rect(0,0,g,8,"F");try{e.addImage(ye,"PNG",g/2-25,30,50,25)}catch{e.setFillColor(248,250,252),e.roundedRect(g/2-30,35,60,20,3,3,"F"),e.setFontSize(10),e.setTextColor(m[0],m[1],m[2]),e.setFont("helvetica","bold"),e.text(t("tools.operatingAgreement.pdf.easyUsLlc"),g/2,47,{align:"center"})}let n=80;e.setTextColor(l[0],l[1],l[2]),e.setFontSize(28),e.setFont("helvetica","bold"),e.text(t("tools.operatingAgreement.pdf.title"),g/2,n,{align:"center"}),n+=12,e.setFontSize(14),e.setTextColor(r[0],r[1],r[2]),e.text(t("tools.operatingAgreement.pdf.of"),g/2,n,{align:"center"}),n+=16,e.setFontSize(22),e.setTextColor(l[0],l[1],l[2]),e.setFont("helvetica","bold"),e.text(T,g/2,n,{align:"center"}),n+=25,e.setDrawColor(m[0],m[1],m[2]),e.setLineWidth(2),e.line(g/2-40,n,g/2+40,n),n+=25,e.setFont("helvetica","normal"),e.setFontSize(11),e.setTextColor(r[0],r[1],r[2]);const oe=t("tools.operatingAgreement.pdf.intro"),W=e.splitTextToSize(oe,x-40);e.text(W,g/2,n,{align:"center"}),n+=W.length*6+20,e.setFillColor(248,250,252),e.roundedRect(s+20,n,x-40,30,4,4,"F"),e.setFontSize(10),e.setTextColor(r[0],r[1],r[2]),e.text(t("tools.operatingAgreement.pdf.effectiveDate"),g/2,n+12,{align:"center"}),e.setFontSize(14),e.setTextColor(l[0],l[1],l[2]),e.setFont("helvetica","bold"),e.text(q(u.effectiveDate),g/2,n+24,{align:"center"}),D(),e.addPage(),S++,P(),n=25;const p=(f,A)=>{n=N(20),e.setFillColor(m[0],m[1],m[2]),e.roundedRect(s,n,8,8,1,1,"F"),e.setFontSize(10),e.setTextColor(255,255,255),e.setFont("helvetica","bold"),e.text(String(f),s+4,n+5.5,{align:"center"}),e.setFontSize(13),e.setTextColor(l[0],l[1],l[2]),e.text(A,s+12,n+6),n+=14},c=(f,A=!1)=>{e.setFontSize(10),e.setFont("helvetica","normal"),e.setTextColor(r[0],r[1],r[2]);const ae=A?s+8:s,ie=A?x-8:x,k=e.splitTextToSize(f,ie);n=N(k.length*5+5),e.text(k,ae,n),n+=k.length*5+6},h=(f,A)=>{n=N(12),e.setFontSize(9),e.setFont("helvetica","bold"),e.setTextColor(r[0],r[1],r[2]),e.text(f,s+8,n),e.setFont("helvetica","normal"),e.setTextColor(l[0],l[1],l[2]),e.text(A,s+8+e.getTextWidth(f)+3,n),n+=6},d=f=>{n=N(8),e.setFillColor(m[0],m[1],m[2]),e.circle(s+10,n-1.5,1.5,"F"),e.setFontSize(10),e.setFont("helvetica","normal"),e.setTextColor(r[0],r[1],r[2]);const A=e.splitTextToSize(f,x-20);e.text(A,s+16,n),n+=A.length*5+3};p(1,t("tools.operatingAgreement.pdf.section1Title")),c(t("tools.operatingAgreement.pdf.section1Content",{companyName:T,state:a.state})),p(2,t("tools.operatingAgreement.pdf.section2Title")),n+=2,h(t("tools.operatingAgreement.pdf.legalName"),T),h(t("tools.operatingAgreement.pdf.stateOfFormation"),a.state),h(t("tools.operatingAgreement.pdf.formationDate"),q(a.llcCreatedDate)),h(t("tools.operatingAgreement.pdf.ein"),a.ein||""),n+=4,h(t("tools.operatingAgreement.pdf.registeredAddress"),""),e.setFontSize(9),e.setFont("helvetica","normal"),e.setTextColor(l[0],l[1],l[2]),e.text(t("tools.operatingAgreement.pdf.registeredAddressLine1"),s+8,n),n+=5,e.text(t("tools.operatingAgreement.pdf.registeredAddressLine2"),s+8,n),n+=5,e.text(t("tools.operatingAgreement.pdf.registeredAddressLine3"),s+8,n),n+=5,e.text(t("tools.operatingAgreement.pdf.unitedStates"),s+8,n),n+=10,p(3,t("tools.operatingAgreement.pdf.section3Title")),c(t("tools.operatingAgreement.pdf.section3Intro")),n+=2,h(t("tools.operatingAgreement.pdf.memberName"),a.ownerFullName),h(t("tools.operatingAgreement.pdf.govId"),`${a.ownerIdType} ${a.ownerIdNumber}`),h(t("tools.operatingAgreement.pdf.residentialAddress"),u.memberAddress),u.memberPhone&&h(t("tools.operatingAgreement.pdf.telephone"),u.memberPhone),h(t("tools.operatingAgreement.pdf.email"),a.ownerEmail),h(t("tools.operatingAgreement.pdf.ownership"),"100%"),n+=4,c(t("tools.operatingAgreement.pdf.section3Outro")),p(4,t("tools.operatingAgreement.pdf.section4Title")),c(t("tools.operatingAgreement.pdf.section4Intro")),d(t("tools.operatingAgreement.pdf.purpose1")),d(t("tools.operatingAgreement.pdf.purpose2")),d(t("tools.operatingAgreement.pdf.purpose3")),d(t("tools.operatingAgreement.pdf.purpose4")),d(t("tools.operatingAgreement.pdf.purpose5")),c(t("tools.operatingAgreement.pdf.section4Outro")),p(5,t("tools.operatingAgreement.pdf.section5Title")),c(t("tools.operatingAgreement.pdf.section5Intro")),d(t("tools.operatingAgreement.pdf.management1")),d(t("tools.operatingAgreement.pdf.management2")),d(t("tools.operatingAgreement.pdf.management3")),d(t("tools.operatingAgreement.pdf.management4")),d(t("tools.operatingAgreement.pdf.management5")),d(t("tools.operatingAgreement.pdf.management6")),p(6,t("tools.operatingAgreement.pdf.section6Title")),c(t("tools.operatingAgreement.pdf.section6Content")),u.capitalContribution&&h(t("tools.operatingAgreement.pdf.initialContribution"),`$${u.capitalContribution} USD`),c(t("tools.operatingAgreement.pdf.section6Outro")),p(7,t("tools.operatingAgreement.pdf.section7Title")),c(t("tools.operatingAgreement.pdf.section7Content")),p(8,t("tools.operatingAgreement.pdf.section8Title")),c(t("tools.operatingAgreement.pdf.section8Intro")),d("IRS Form 1120"),d("IRS Form 5472"),d(t("tools.operatingAgreement.pdf.federalState")),p(9,t("tools.operatingAgreement.pdf.section9Title")),c(t("tools.operatingAgreement.pdf.section9Content")),p(10,t("tools.operatingAgreement.pdf.section10Title")),c(t("tools.operatingAgreement.pdf.section10Content")),p(11,t("tools.operatingAgreement.pdf.section11Title")),c(t("tools.operatingAgreement.pdf.section11Intro")),d(t("tools.operatingAgreement.pdf.record1")),d(t("tools.operatingAgreement.pdf.record2")),d(t("tools.operatingAgreement.pdf.record3")),d(t("tools.operatingAgreement.pdf.record4")),d(t("tools.operatingAgreement.pdf.record5")),c(t("tools.operatingAgreement.pdf.section11Outro")),p(12,t("tools.operatingAgreement.pdf.section12Title")),c(t("tools.operatingAgreement.pdf.section12Content")),p(13,t("tools.operatingAgreement.pdf.section13Title")),c(t("tools.operatingAgreement.pdf.section13Content")),p(14,t("tools.operatingAgreement.pdf.section14Title")),c(t("tools.operatingAgreement.pdf.section14Intro")),d(t("tools.operatingAgreement.pdf.funds1")),d(t("tools.operatingAgreement.pdf.funds2")),d(t("tools.operatingAgreement.pdf.funds3")),d(t("tools.operatingAgreement.pdf.funds4")),c(t("tools.operatingAgreement.pdf.section14Outro")),p(15,t("tools.operatingAgreement.pdf.section15Title")),c(t("tools.operatingAgreement.pdf.section15Content")),p(16,t("tools.operatingAgreement.pdf.section16Title")),c(t("tools.operatingAgreement.pdf.section16Content",{state:a.state})),n=N(100),n<50&&(e.addPage(),S++,P(),n=30),n+=10,e.setFontSize(14),e.setFont("helvetica","bold"),e.setTextColor(l[0],l[1],l[2]),e.text(t("tools.operatingAgreement.pdf.memberConfirmation"),s,n),n+=8,e.setFontSize(10),e.setFont("helvetica","normal"),e.setTextColor(r[0],r[1],r[2]);const ne=t("tools.operatingAgreement.pdf.confirmationText"),B=e.splitTextToSize(ne,x);e.text(B,s,n),n+=B.length*5+15,e.setDrawColor(b[0],b[1],b[2]),e.setLineWidth(.5),e.roundedRect(s,n,x,50,3,3,"S"),e.setFontSize(9),e.setTextColor(r[0],r[1],r[2]),e.text(t("tools.operatingAgreement.pdf.memberNameLabel"),s+8,n+12),e.setTextColor(l[0],l[1],l[2]),e.setFont("helvetica","bold"),e.text(a.ownerFullName,s+8,n+20),e.setFont("helvetica","normal"),e.setTextColor(r[0],r[1],r[2]),e.text(t("tools.operatingAgreement.pdf.signature"),s+8,n+35),e.setDrawColor(l[0],l[1],l[2]),e.line(s+8+e.getTextWidth(t("tools.operatingAgreement.pdf.signature"))+5,n+35,s+x/2-10,n+35),e.text(t("tools.operatingAgreement.pdf.dateLabel"),s+x/2+10,n+35),e.line(s+x/2+10+e.getTextWidth(t("tools.operatingAgreement.pdf.dateLabel"))+5,n+35,s+x-8,n+35),n+=70,e.setFillColor(248,250,252),e.roundedRect(s,n,x,35,3,3,"F"),e.setFontSize(9),e.setTextColor(r[0],r[1],r[2]),e.text(t("tools.operatingAgreement.pdf.preparedBy"),s+8,n+10),e.setFontSize(12),e.setTextColor(m[0],m[1],m[2]),e.setFont("helvetica","bold"),e.text(t("tools.operatingAgreement.pdf.easyUsLlc"),s+8,n+20),e.setFontSize(8),e.setFont("helvetica","normal"),e.setTextColor(r[0],r[1],r[2]),e.text(t("tools.operatingAgreement.pdf.corporateServices"),s+8,n+27);const re=t("tools.operatingAgreement.pdf.contactEmail"),G=t("tools.operatingAgreement.pdf.contactPhone");e.text(re,s+x-8-e.getTextWidth(G)-40,n+20,{align:"left"}),e.text(G,s+x-8,n+20,{align:"right"}),D();const U=`Operating_Agreement_${a.companyName.replace(/\s+/g,"_")}.pdf`,se=e.output("datauristring");e.save(U);try{await Z.mutateAsync({llcApplicationId:a.id,pdfBase64:se,fileName:U})}catch(f){console.error("Error saving to Document Center:",f)}}catch(i){console.error("Error generating PDF:",i)}finally{_(!1)}}};return o.jsxs("div",{className:"min-h-screen bg-background flex flex-col",children:[o.jsx(ve,{}),o.jsx("main",{className:"flex-1 py-8 px-4",children:o.jsxs("div",{className:"max-w-2xl mx-auto",children:[o.jsx("div",{className:"mb-6",children:o.jsx(Fe,{href:"/dashboard?tab=tools",children:o.jsxs(w,{variant:"ghost",size:"sm",className:"rounded-full text-muted-foreground hover:text-foreground -ml-2","data-testid":"button-back-tools",children:[o.jsx(de,{className:"w-4 h-4 mr-2"}),t("tools.backToTools")]})})}),o.jsxs(fe,{className:"rounded-2xl border-0 shadow-md",children:[o.jsx(ue,{className:"bg-accent/10 border-b border-accent/20 p-6",children:o.jsxs("div",{children:[o.jsx(he,{className:"text-xl font-black text-foreground tracking-tight",children:t("tools.operatingAgreement.title")}),o.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:t("tools.operatingAgreement.subtitle")})]})}),o.jsx(Ae,{className:"p-6",children:Y?o.jsx("div",{className:"flex items-center justify-center py-12",children:o.jsx(H,{className:"w-8 h-8 animate-spin text-accent"})}):ee?o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{children:[o.jsxs(C,{className:"text-sm font-bold text-foreground mb-2 flex items-center gap-2",children:[o.jsx(V,{className:"w-4 h-4 text-accent"}),t("tools.operatingAgreement.selectLlc")]}),o.jsxs(be,{value:R,onValueChange:J,className:"h-12 rounded-full","data-testid":"select-llc",children:[o.jsx("option",{value:"",children:t("tools.operatingAgreement.selectPlaceholder")}),v?.map(i=>o.jsxs("option",{value:String(i.id),children:[i.companyName," ",i.designator||"LLC"," - ",i.state,!i.ein&&` (${t("tools.operatingAgreement.pendingEin")})`]},i.id))]})]}),a&&o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"bg-muted/50 rounded-xl p-4 space-y-3",children:[o.jsxs("h4",{className:"font-bold text-sm text-foreground flex items-center gap-2",children:[o.jsx(V,{className:"w-4 h-4 text-accent"}),t("tools.operatingAgreement.llcDetails")]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[o.jsxs("div",{children:[o.jsxs("span",{className:"text-muted-foreground",children:[t("tools.operatingAgreement.companyName"),":"]}),o.jsxs("p",{className:"font-medium text-foreground",children:[a.companyName," ",a.designator||"LLC"]})]}),o.jsxs("div",{children:[o.jsxs("span",{className:"text-muted-foreground",children:[t("tools.operatingAgreement.state"),":"]}),o.jsx("p",{className:"font-medium text-foreground",children:a.state})]}),o.jsxs("div",{children:[o.jsx("span",{className:"text-muted-foreground",children:"EIN:"}),o.jsx("p",{className:`font-mono font-medium ${a.ein?"text-foreground":"text-destructive"}`,children:a.ein||t("tools.operatingAgreement.einPending")})]}),o.jsxs("div",{children:[o.jsxs("span",{className:"text-muted-foreground",children:[t("tools.operatingAgreement.member"),":"]}),o.jsx("p",{className:"font-medium text-foreground",children:a.ownerFullName})]})]})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("h4",{className:"font-bold text-sm text-foreground flex items-center gap-2",children:[o.jsx(me,{className:"w-4 h-4 text-accent"}),t("tools.operatingAgreement.editableFields")]}),o.jsxs("div",{children:[o.jsxs(C,{className:"text-sm font-medium text-foreground mb-2 flex items-center gap-2",children:[o.jsx(ge,{className:"w-4 h-4 text-muted-foreground"}),t("tools.operatingAgreement.memberAddress")," *"]}),o.jsx(je,{value:u.memberAddress,onChange:i=>j(e=>({...e,memberAddress:i.target.value})),placeholder:t("tools.operatingAgreement.addressPlaceholder"),className:"min-h-[80px] resize-none rounded-xl","data-testid":"input-member-address"})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsxs(C,{className:"text-sm font-medium text-foreground mb-2 flex items-center gap-2",children:[o.jsx(ce,{className:"w-4 h-4 text-muted-foreground"}),t("tools.operatingAgreement.memberPhone")]}),o.jsx(I,{value:u.memberPhone,onChange:i=>j(e=>({...e,memberPhone:i.target.value})),placeholder:"+34 600 000 000",className:"h-11 rounded-full","data-testid":"input-member-phone"})]}),o.jsxs("div",{children:[o.jsx(C,{className:"text-sm font-medium text-foreground mb-2",children:t("tools.operatingAgreement.capitalContribution")}),o.jsx(I,{value:u.capitalContribution,onChange:i=>j(e=>({...e,capitalContribution:i.target.value})),placeholder:"1,000",className:"h-11 rounded-full","data-testid":"input-capital"})]})]}),o.jsxs("div",{children:[o.jsxs(C,{className:"text-sm font-medium text-foreground mb-2 block",children:[t("tools.operatingAgreement.effectiveDate")," *"]}),o.jsx(I,{type:"date",value:u.effectiveDate,onChange:i=>j(e=>({...e,effectiveDate:i.target.value})),className:"h-11 rounded-full","data-testid":"input-effective-date"})]})]}),a.ein?L?o.jsxs("div",{className:"bg-green-50 dark:bg-green-950/30 border border-green-200 dark:border-green-800 rounded-xl p-4 flex items-start gap-3",children:[o.jsx(pe,{className:"w-5 h-5 text-green-600 shrink-0 mt-0.5"}),o.jsxs("div",{children:[o.jsx("p",{className:"font-bold text-green-800 dark:text-green-200 text-sm",children:t("tools.operatingAgreement.readyToGenerate")}),o.jsx("p",{className:"text-green-700 dark:text-green-300 text-xs mt-1",children:t("tools.operatingAgreement.readyDescription")})]})]}):o.jsxs("div",{className:"bg-amber-50 dark:bg-amber-950/30 border border-amber-200 dark:border-amber-800 rounded-xl p-4 flex items-start gap-3",children:[o.jsx(z,{className:"w-5 h-5 text-amber-600 shrink-0 mt-0.5"}),o.jsxs("div",{children:[o.jsx("p",{className:"font-bold text-amber-800 dark:text-amber-200 text-sm",children:t("tools.operatingAgreement.requiredFields")}),o.jsx("p",{className:"text-amber-700 dark:text-amber-300 text-xs mt-1",children:t("tools.operatingAgreement.requiredFieldsDescription")})]})]}):o.jsxs("div",{className:"bg-amber-50 dark:bg-amber-950/30 border border-amber-200 dark:border-amber-800 rounded-xl p-4 flex items-start gap-3",children:[o.jsx(z,{className:"w-5 h-5 text-amber-600 shrink-0 mt-0.5"}),o.jsxs("div",{children:[o.jsx("p",{className:"font-bold text-amber-800 dark:text-amber-200 text-sm",children:t("tools.operatingAgreement.einRequired")}),o.jsx("p",{className:"text-amber-700 dark:text-amber-300 text-xs mt-1",children:t("tools.operatingAgreement.einRequiredDescription")})]})]}),o.jsx(w,{onClick:te,disabled:!a.ein||!L||O,className:"w-full bg-accent text-accent-foreground rounded-full h-12 font-bold text-base disabled:opacity-50","data-testid":"button-generate-agreement",children:O?o.jsxs(o.Fragment,{children:[o.jsx(H,{className:"w-5 h-5 mr-2 animate-spin"}),t("tools.operatingAgreement.generating")]}):o.jsxs(o.Fragment,{children:[o.jsx(xe,{className:"w-5 h-5 mr-2"}),t("tools.operatingAgreement.generateButton")]})})]})]}):o.jsxs("div",{className:"text-center py-12",children:[o.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full bg-muted flex items-center justify-center",children:o.jsx(z,{className:"w-8 h-8 text-muted-foreground"})}),o.jsx("h3",{className:"text-lg font-bold text-foreground mb-2",children:t("tools.operatingAgreement.noLlc")}),o.jsx("p",{className:"text-muted-foreground text-sm mb-6 max-w-sm mx-auto",children:t("tools.operatingAgreement.noLlcDescription")}),o.jsx(w,{onClick:()=>$("/llc/formation"),className:"bg-accent text-accent-foreground rounded-full px-6",children:t("tools.operatingAgreement.formLlc")})]})})]})]})}),o.jsx(Te,{})]})}export{We as default};
