{
  "version": 3,
  "sources": ["../shared/models/auth.ts", "../shared/schema.ts", "../vite.config.ts", "../node_modules/nanoid/url-alphabet/index.js", "../node_modules/nanoid/index.js", "../server/vite.ts", "../server/index.ts", "../server/replit_integrations/auth/replitAuth.ts", "../server/replit_integrations/auth/storage.ts", "../server/db.ts", "../server/replit_integrations/auth/routes.ts", "../server/storage.ts", "../shared/routes.ts", "../server/routes.ts", "../server/lib/email.ts", "../server/static.ts"],
  "sourcesContent": ["import { sql } from \"drizzle-orm\";\nimport { index, jsonb, pgTable, timestamp, varchar, boolean } from \"drizzle-orm/pg-core\";\n\n// Session storage table.\n// (IMPORTANT) This table is mandatory for Replit Auth, don't drop it.\nexport const sessions = pgTable(\n  \"sessions\",\n  {\n    sid: varchar(\"sid\").primaryKey(),\n    sess: jsonb(\"sess\").notNull(),\n    expire: timestamp(\"expire\").notNull(),\n  },\n  (table) => [index(\"IDX_session_expire\").on(table.expire)]\n);\n\n// User storage table.\n// (IMPORTANT) This table is mandatory for Replit Auth, don't drop it.\nexport const users = pgTable(\"users\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  email: varchar(\"email\").unique(),\n  firstName: varchar(\"first_name\"),\n  lastName: varchar(\"last_name\"),\n  profileImageUrl: varchar(\"profile_image_url\"),\n  phone: varchar(\"phone\"),\n  emailVerified: boolean(\"email_verified\").notNull().default(false),\n  isAdmin: boolean(\"is_admin\").notNull().default(false),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\nexport type UpsertUser = typeof users.$inferInsert;\nexport type User = typeof users.$inferSelect;\n", "export * from \"./models/auth\";\nimport { pgTable, text, serial, integer, boolean, timestamp, jsonb, varchar } from \"drizzle-orm/pg-core\";\nimport { createInsertSchema } from \"drizzle-zod\";\nimport { z } from \"zod\";\nimport { users } from \"./models/auth\";\nimport { relations } from \"drizzle-orm\";\n\nexport const products = pgTable(\"products\", {\n  id: serial(\"id\").primaryKey(),\n  name: text(\"name\").notNull(),\n  description: text(\"description\").notNull(),\n  price: integer(\"price\").notNull(), // in cents\n  features: jsonb(\"features\").$type<string[]>().notNull(),\n});\n\nexport const orders = pgTable(\"orders\", {\n  id: serial(\"id\").primaryKey(),\n  userId: varchar(\"user_id\").notNull().references(() => users.id),\n  productId: integer(\"product_id\").notNull().references(() => products.id),\n  status: text(\"status\").notNull().default(\"pending\"), // pending, paid, cancelled\n  stripeSessionId: text(\"stripe_session_id\"),\n  amount: integer(\"amount\").notNull(),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\nexport const llcApplications = pgTable(\"llc_applications\", {\n  id: serial(\"id\").primaryKey(),\n  orderId: integer(\"order_id\").notNull().references(() => orders.id),\n  requestCode: text(\"request_code\").unique(),\n  ownerFullName: text(\"owner_full_name\"),\n  ownerEmail: text(\"owner_email\"),\n  ownerPhone: text(\"owner_phone\"),\n  ownerBirthDate: text(\"owner_birth_date\"),\n  ownerAddress: text(\"owner_address\"),\n  ownerStreetType: text(\"owner_street_type\"), // Calle, Avenida, Paseo\n  ownerCity: text(\"owner_city\"),\n  ownerCountry: text(\"owner_country\"),\n  ownerProvince: text(\"owner_province\"),\n  ownerPostalCode: text(\"owner_postal_code\"),\n  ownerIdNumber: text(\"owner_id_number\"), // DNI/Passport number\n  ownerIdType: text(\"owner_id_type\"), // DNI or Passport\n  idLater: boolean(\"id_later\").notNull().default(false),\n  dataProcessingConsent: boolean(\"data_processing_consent\").notNull().default(false),\n  termsConsent: boolean(\"terms_consent\").notNull().default(false),\n  ageConfirmation: boolean(\"age_confirmation\").notNull().default(false),\n  companyName: text(\"company_name\"),\n  companyNameOption2: text(\"company_name_option_2\"),\n  designator: text(\"designator\"), // LLC, L.L.C., Ltd.\n  companyDescription: text(\"company_description\"),\n  businessCategory: text(\"business_category\"),\n  businessActivity: text(\"business_activity\"),\n  businessCategoryOther: text(\"business_category_other\"),\n  ownerNamesAlternates: text(\"owner_names_alternates\"), // Plan B, C, D names\n  ownerCount: integer(\"owner_count\").default(1),\n  ownerCountryResidency: text(\"owner_country_residency\"),\n  idDocumentUrl: text(\"id_document_url\"),\n  isSellingOnline: text(\"is_selling_online\"), // Yes, No, Not sure\n  needsBankAccount: text(\"needs_bank_account\"), // Mercury, Relay, No, Yes\n  willUseStripe: text(\"will_use_stripe\"), // Stripe, PayPal, Both, Other, Not yet\n  wantsBoiReport: text(\"wants_boi_report\"), // Yes, No, Info\n  wantsMaintenancePack: text(\"wants_maintenance_pack\"), // Yes, No, Info\n  paymentStatus: text(\"payment_status\").notNull().default(\"unpaid\"), // unpaid, paid\n  notes: text(\"notes\"),\n  state: text(\"state\"),\n  status: text(\"status\").notNull().default(\"draft\"), // draft, submitted, filed, rejected\n  submittedAt: timestamp(\"submitted_at\"),\n  lastUpdated: timestamp(\"last_updated\").defaultNow(),\n  emailOtp: text(\"email_otp\"),\n  emailOtpExpires: timestamp(\"email_otp_expires\"),\n  emailVerified: boolean(\"email_verified\").notNull().default(false),\n});\n\n// Application documents table\nexport const applicationDocuments = pgTable(\"application_documents\", {\n  id: serial(\"id\").primaryKey(),\n  applicationId: integer(\"application_id\").notNull().references(() => llcApplications.id),\n  fileName: text(\"file_name\").notNull(),\n  fileType: text(\"file_type\").notNull(),\n  fileUrl: text(\"file_url\").notNull(),\n  documentType: text(\"document_type\").notNull(), // passport, id, other\n  uploadedAt: timestamp(\"uploaded_at\").defaultNow(),\n});\n\n// Relations\nexport const newsletterSubscribers = pgTable(\"newsletter_subscribers\", {\n  id: serial(\"id\").primaryKey(),\n  email: text(\"email\").notNull().unique(),\n  subscribedAt: timestamp(\"subscribed_at\").defaultNow(),\n});\n\nexport const contactOtps = pgTable(\"contact_otps\", {\n  id: serial(\"id\").primaryKey(),\n  email: text(\"email\").notNull(),\n  otp: text(\"otp\").notNull(),\n  expiresAt: timestamp(\"expires_at\").notNull(),\n  verified: boolean(\"verified\").notNull().default(false),\n});\n\nexport const ordersRelations = relations(orders, ({ one, many }) => ({\n  user: one(users, { fields: [orders.userId], references: [users.id] }),\n  product: one(products, { fields: [orders.productId], references: [products.id] }),\n  application: one(llcApplications, { fields: [orders.id], references: [llcApplications.orderId] }),\n}));\n\nexport const llcApplicationsRelations = relations(llcApplications, ({ one, many }) => ({\n  order: one(orders, { fields: [llcApplications.orderId], references: [orders.id] }),\n  documents: many(applicationDocuments),\n}));\n\nexport const applicationDocumentsRelations = relations(applicationDocuments, ({ one }) => ({\n  application: one(llcApplications, { fields: [applicationDocuments.applicationId], references: [llcApplications.id] }),\n}));\n\n// Schemas\nexport const insertProductSchema = createInsertSchema(products).omit({ id: true });\nexport const insertOrderSchema = createInsertSchema(orders).omit({ id: true, createdAt: true });\nexport const insertLlcApplicationSchema = createInsertSchema(llcApplications).omit({ id: true, lastUpdated: true });\nexport const insertApplicationDocumentSchema = createInsertSchema(applicationDocuments).omit({ id: true, uploadedAt: true });\n\nexport const maintenanceApplications = pgTable(\"maintenance_applications\", {\n  id: serial(\"id\").primaryKey(),\n  orderId: integer(\"order_id\").notNull().references(() => orders.id),\n  requestCode: text(\"request_code\").unique(),\n  ownerFullName: text(\"owner_full_name\"),\n  ownerEmail: text(\"owner_email\"),\n  ownerPhone: text(\"owner_phone\"),\n  companyName: text(\"company_name\"),\n  ein: text(\"ein\"),\n  state: text(\"state\"),\n  creationSource: text(\"creation_source\"),\n  creationYear: text(\"creation_year\"),\n  bankAccount: text(\"bank_account\"),\n  paymentGateway: text(\"payment_gateway\"),\n  businessActivity: text(\"business_activity\"),\n  expectedServices: text(\"expected_services\"),\n  status: text(\"status\").notNull().default(\"draft\"),\n  submittedAt: timestamp(\"submitted_at\"),\n  lastUpdated: timestamp(\"last_updated\").defaultNow(),\n  emailOtp: text(\"email_otp\"),\n  emailOtpExpires: timestamp(\"email_otp_expires\"),\n  emailVerified: boolean(\"email_verified\").notNull().default(false),\n  notes: text(\"notes\"),\n  wantsDissolve: text(\"wants_dissolve\"),\n  authorizedManagement: boolean(\"authorized_management\").notNull().default(false),\n  termsConsent: boolean(\"terms_consent\").notNull().default(false),\n  dataProcessingConsent: boolean(\"data_processing_consent\").notNull().default(false),\n});\n\nexport const insertMaintenanceApplicationSchema = createInsertSchema(maintenanceApplications).omit({ id: true, lastUpdated: true });\n\nexport const insertContactOtpSchema = createInsertSchema(contactOtps).omit({ id: true });\n\nexport type MaintenanceApplication = typeof maintenanceApplications.$inferSelect;\n\nexport const maintenanceApplicationsRelations = relations(maintenanceApplications, ({ one }) => ({\n  order: one(orders, { fields: [maintenanceApplications.orderId], references: [orders.id] }),\n}));\n\n// Types\nexport type Product = typeof products.$inferSelect;\nexport type Order = typeof orders.$inferSelect;\nexport type LlcApplication = typeof llcApplications.$inferSelect;\nexport type ApplicationDocument = typeof applicationDocuments.$inferSelect;\n\n// Request Types\nexport type CreateOrderRequest = {\n  productId: number;\n};\nexport type UpdateLlcApplicationRequest = Partial<z.infer<typeof insertLlcApplicationSchema>>;\nexport type CreateDocumentRequest = z.infer<typeof insertApplicationDocumentSchema>;\n\n", "import { defineConfig } from \"vite\";\nimport react from \"@vitejs/plugin-react\";\nimport path from \"path\";\n\nexport default defineConfig({\n  plugins: [\n    react(),\n  ],\n  resolve: {\n    alias: {\n      \"@\": path.resolve(import.meta.dirname, \"client\", \"src\"),\n      \"@shared\": path.resolve(import.meta.dirname, \"shared\"),\n      \"@assets\": path.resolve(import.meta.dirname, \"client\", \"src\", \"assets\"),\n    },\n  },\n  root: path.resolve(import.meta.dirname, \"client\"),\n  build: {\n    outDir: path.resolve(import.meta.dirname, \"dist/public\"),\n    emptyOutDir: true,\n    reportCompressedSize: false,\n    chunkSizeWarningLimit: 1000,\n    rollupOptions: {\n      output: {\n        manualChunks: {\n          vendor: ['react', 'react-dom', 'framer-motion'],\n          ui: ['lucide-react', '@radix-ui/react-dialog', '@radix-ui/react-select'],\n        }\n      }\n    }\n  },\n  server: {\n    fs: {\n      strict: true,\n      deny: [\"**/.*\"],\n    },\n    allowedHosts: true,\n  },\n});\n", "let urlAlphabet =\n  'useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict'\nexport { urlAlphabet }\n", "import crypto from 'crypto'\nimport { urlAlphabet } from './url-alphabet/index.js'\nconst POOL_SIZE_MULTIPLIER = 128\nlet pool, poolOffset\nlet fillPool = bytes => {\n  if (!pool || pool.length < bytes) {\n    pool = Buffer.allocUnsafe(bytes * POOL_SIZE_MULTIPLIER)\n    crypto.randomFillSync(pool)\n    poolOffset = 0\n  } else if (poolOffset + bytes > pool.length) {\n    crypto.randomFillSync(pool)\n    poolOffset = 0\n  }\n  poolOffset += bytes\n}\nlet random = bytes => {\n  fillPool((bytes |= 0))\n  return pool.subarray(poolOffset - bytes, poolOffset)\n}\nlet customRandom = (alphabet, defaultSize, getRandom) => {\n  let mask = (2 << (31 - Math.clz32((alphabet.length - 1) | 1))) - 1\n  let step = Math.ceil((1.6 * mask * defaultSize) / alphabet.length)\n  return (size = defaultSize) => {\n    let id = ''\n    while (true) {\n      let bytes = getRandom(step)\n      let i = step\n      while (i--) {\n        id += alphabet[bytes[i] & mask] || ''\n        if (id.length === size) return id\n      }\n    }\n  }\n}\nlet customAlphabet = (alphabet, size = 21) =>\n  customRandom(alphabet, size, random)\nlet nanoid = (size = 21) => {\n  fillPool((size |= 0))\n  let id = ''\n  for (let i = poolOffset - size; i < poolOffset; i++) {\n    id += urlAlphabet[pool[i] & 63]\n  }\n  return id\n}\nexport { nanoid, customAlphabet, customRandom, urlAlphabet, random }\n", "import { type Express } from \"express\";\nimport { createServer as createViteServer, createLogger } from \"vite\";\nimport { type Server } from \"http\";\nimport viteConfig from \"../vite.config\";\nimport fs from \"fs\";\nimport path from \"path\";\nimport { nanoid } from \"nanoid\";\n\nconst viteLogger = createLogger();\n\nexport async function setupVite(server: Server, app: Express) {\n  const serverOptions = {\n    middlewareMode: true,\n    hmr: { server, path: \"/vite-hmr\" },\n    allowedHosts: true as const,\n  };\n\n  const vite = await createViteServer({\n    ...viteConfig,\n    configFile: false,\n    customLogger: {\n      ...viteLogger,\n      error: (msg, options) => {\n        viteLogger.error(msg, options);\n        process.exit(1);\n      },\n    },\n    server: serverOptions,\n    appType: \"custom\",\n  });\n\n  app.use(vite.middlewares);\n\n  app.use(\"*\", async (req, res, next) => {\n    const url = req.originalUrl;\n\n    try {\n      const clientTemplate = path.resolve(\n        import.meta.dirname,\n        \"..\",\n        \"client\",\n        \"index.html\",\n      );\n\n      // always reload the index.html file from disk incase it changes\n      let template = await fs.promises.readFile(clientTemplate, \"utf-8\");\n      template = template.replace(\n        `src=\"/src/main.tsx\"`,\n        `src=\"/src/main.tsx?v=${nanoid()}\"`,\n      );\n      const page = await vite.transformIndexHtml(url, template);\n      res.status(200).set({ \"Content-Type\": \"text/html\" }).end(page);\n    } catch (e) {\n      vite.ssrFixStacktrace(e as Error);\n      next(e);\n    }\n  });\n}\n", "import express, { type Request, Response, NextFunction } from \"express\";\nimport { registerRoutes } from \"./routes\";\nimport { serveStatic } from \"./static\";\nimport { createServer } from \"http\";\nimport compression from \"compression\";\n\nconst app = express();\nconst httpServer = createServer(app);\n\napp.use(compression());\napp.use(express.json());\napp.use(express.urlencoded({ extended: false }));\n\nexport function log(message: string, source = \"express\") {\n  const formattedTime = new Date().toLocaleTimeString(\"en-US\", {\n    hour: \"numeric\",\n    minute: \"2-digit\",\n    second: \"2-digit\",\n    hour12: true,\n  });\n\n  console.log(`${formattedTime} [${source}] ${message}`);\n}\n\napp.use((req, res, next) => {\n  res.setHeader(\"X-Content-Type-Options\", \"nosniff\");\n  res.setHeader(\"X-Frame-Options\", \"DENY\");\n  res.setHeader(\"X-XSS-Protection\", \"1; mode=block\");\n  // Performance Headers\n  if (req.method === 'GET') {\n    const isAsset = req.path.startsWith('/assets/') || req.path.match(/\\.(jpg|jpeg|png|gif|svg|webp|ico|css|js|woff2|woff)$/);\n    if (isAsset) {\n      res.setHeader('Cache-Control', 'public, max-age=31536000, immutable');\n    }\n  }\n  next();\n});\n\n(async () => {\n  await registerRoutes(httpServer, app);\n\n  app.use((err: any, _req: Request, res: Response, _next: NextFunction) => {\n    const status = err.status || err.statusCode || 500;\n    const message = err.message || \"Internal Server Error\";\n\n    res.status(status).json({ message });\n    throw err;\n  });\n\n  // importantly only setup vite in development and after\n  // setting up all the other routes so the catch-all route\n  // doesn't interfere with the other routes\n  if (process.env.NODE_ENV === \"production\") {\n    serveStatic(app);\n  } else {\n    const { setupVite } = await import(\"./vite\");\n    await setupVite(httpServer, app);\n  }\n\n  // ALWAYS serve the app on the port specified in the environment variable PORT\n  // Other ports are firewalled. Default to 5000 if not specified.\n  // this serves both the API and the client.\n  // It is the only port that is not firewalled.\n  const port = parseInt(process.env.PORT || \"5000\", 10);\n  httpServer.listen(\n    {\n      port,\n      host: \"0.0.0.0\",\n      reusePort: true,\n    },\n    () => {\n      log(`serving on port ${port}`);\n    },\n  );\n})();\n", "import * as client from \"openid-client\";\nimport { Strategy, type VerifyFunction } from \"openid-client/passport\";\n\nimport passport from \"passport\";\nimport session from \"express-session\";\nimport type { Express, RequestHandler } from \"express\";\nimport memoize from \"memoizee\";\nimport connectPg from \"connect-pg-simple\";\nimport { authStorage } from \"./storage\";\n\nconst getOidcConfig = memoize(\n  async () => {\n    return await client.discovery(\n      new URL(process.env.ISSUER_URL ?? \"https://replit.com/oidc\"),\n      process.env.REPL_ID!\n    );\n  },\n  { maxAge: 3600 * 1000 }\n);\n\nexport function getSession() {\n  const sessionTtl = 7 * 24 * 60 * 60 * 1000; // 1 week\n  const pgStore = connectPg(session);\n  const sessionStore = new pgStore({\n    conString: process.env.DATABASE_URL,\n    createTableIfMissing: false,\n    ttl: sessionTtl,\n    tableName: \"sessions\",\n  });\n  return session({\n    secret: process.env.SESSION_SECRET!,\n    store: sessionStore,\n    resave: false,\n    saveUninitialized: false,\n    cookie: {\n      httpOnly: true,\n      secure: true,\n      maxAge: sessionTtl,\n    },\n  });\n}\n\nfunction updateUserSession(\n  user: any,\n  tokens: client.TokenEndpointResponse & client.TokenEndpointResponseHelpers\n) {\n  user.claims = tokens.claims();\n  user.access_token = tokens.access_token;\n  user.refresh_token = tokens.refresh_token;\n  user.expires_at = user.claims?.exp;\n}\n\nasync function upsertUser(claims: any) {\n  await authStorage.upsertUser({\n    id: claims[\"sub\"],\n    email: claims[\"email\"],\n    firstName: claims[\"first_name\"],\n    lastName: claims[\"last_name\"],\n    profileImageUrl: claims[\"profile_image_url\"],\n  });\n}\n\nexport async function setupAuth(app: Express) {\n  app.set(\"trust proxy\", 1);\n  app.use(getSession());\n  app.use(passport.initialize());\n  app.use(passport.session());\n\n  const config = await getOidcConfig();\n\n  const verify: VerifyFunction = async (\n    tokens: client.TokenEndpointResponse & client.TokenEndpointResponseHelpers,\n    verified: passport.AuthenticateCallback\n  ) => {\n    const user = {};\n    updateUserSession(user, tokens);\n    await upsertUser(tokens.claims());\n    verified(null, user);\n  };\n\n  // Keep track of registered strategies\n  const registeredStrategies = new Set<string>();\n\n  // Helper function to ensure strategy exists for a domain\n  const ensureStrategy = (domain: string) => {\n    const strategyName = `replitauth:${domain}`;\n    if (!registeredStrategies.has(strategyName)) {\n      const strategy = new Strategy(\n        {\n          name: strategyName,\n          config,\n          scope: \"openid email profile offline_access\",\n          callbackURL: `https://${domain}/api/callback`,\n        },\n        verify\n      );\n      passport.use(strategy);\n      registeredStrategies.add(strategyName);\n    }\n  };\n\n  passport.serializeUser((user: Express.User, cb) => cb(null, user));\n  passport.deserializeUser((user: Express.User, cb) => cb(null, user));\n\n  app.get(\"/api/login\", (req, res, next) => {\n    ensureStrategy(req.hostname);\n    passport.authenticate(`replitauth:${req.hostname}`, {\n      prompt: \"login consent\",\n      scope: [\"openid\", \"email\", \"profile\", \"offline_access\"],\n    } as any)(req, res, next);\n  });\n\n  app.get(\"/api/callback\", (req, res, next) => {\n    ensureStrategy(req.hostname);\n    passport.authenticate(`replitauth:${req.hostname}`, {\n      successReturnToOrRedirect: \"/\",\n      failureRedirect: \"/api/login\",\n    })(req, res, next);\n  });\n\n  app.get(\"/api/logout\", (req, res) => {\n    req.logout(() => {\n      res.redirect(\n        client.buildEndSessionUrl(config, {\n          client_id: process.env.REPL_ID!,\n          post_logout_redirect_uri: `${req.protocol}://${req.hostname}`,\n        }).href\n      );\n    });\n  });\n}\n\nexport const isAuthenticated: RequestHandler = async (req, res, next) => {\n  const user = req.user as any;\n\n  if (!req.isAuthenticated() || !user.expires_at) {\n    return res.status(401).json({ message: \"Unauthorized\" });\n  }\n\n  const now = Math.floor(Date.now() / 1000);\n  if (now <= user.expires_at) {\n    return next();\n  }\n\n  const refreshToken = user.refresh_token;\n  if (!refreshToken) {\n    res.status(401).json({ message: \"Unauthorized\" });\n    return;\n  }\n\n  try {\n    const config = await getOidcConfig();\n    const tokenResponse = await client.refreshTokenGrant(config, refreshToken);\n    updateUserSession(user, tokenResponse);\n    return next();\n  } catch (error) {\n    res.status(401).json({ message: \"Unauthorized\" });\n    return;\n  }\n};\n", "import { users, type User, type UpsertUser } from \"@shared/models/auth\";\nimport { db } from \"../../db\";\nimport { eq } from \"drizzle-orm\";\n\n// Interface for auth storage operations\n// (IMPORTANT) These user operations are mandatory for Replit Auth.\nexport interface IAuthStorage {\n  getUser(id: string): Promise<User | undefined>;\n  upsertUser(user: UpsertUser): Promise<User>;\n}\n\nclass AuthStorage implements IAuthStorage {\n  async getUser(id: string): Promise<User | undefined> {\n    const [user] = await db.select().from(users).where(eq(users.id, id));\n    return user;\n  }\n\n  async upsertUser(userData: UpsertUser): Promise<User> {\n    const [user] = await db\n      .insert(users)\n      .values(userData)\n      .onConflictDoUpdate({\n        target: users.id,\n        set: {\n          ...userData,\n          updatedAt: new Date(),\n        },\n      })\n      .returning();\n    return user;\n  }\n}\n\nexport const authStorage = new AuthStorage();\n", "import { drizzle } from \"drizzle-orm/node-postgres\";\nimport pg from \"pg\";\nimport * as schema from \"@shared/schema\";\n\nconst { Pool } = pg;\n\nif (!process.env.DATABASE_URL) {\n  throw new Error(\n    \"DATABASE_URL must be set. Did you forget to provision a database?\",\n  );\n}\n\nexport const pool = new Pool({ connectionString: process.env.DATABASE_URL });\nexport const db = drizzle(pool, { schema });\n", "import type { Express } from \"express\";\nimport { authStorage } from \"./storage\";\nimport { isAuthenticated } from \"./replitAuth\";\n\n// Register auth-specific routes\nexport function registerAuthRoutes(app: Express): void {\n  // Get current authenticated user\n  app.get(\"/api/auth/user\", isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const user = await authStorage.getUser(userId);\n      res.json(user);\n    } catch (error) {\n      console.error(\"Error fetching user:\", error);\n      res.status(500).json({ message: \"Failed to fetch user\" });\n    }\n  });\n}\n", "import { db } from \"./db\";\nimport {\n  products, orders, llcApplications, applicationDocuments, newsletterSubscribers,\n  type Product, type Order, type LlcApplication, type ApplicationDocument,\n  insertLlcApplicationSchema, insertApplicationDocumentSchema, insertOrderSchema\n} from \"@shared/schema\";\nimport { eq, desc } from \"drizzle-orm\";\nimport { z } from \"zod\";\n\ntype InsertOrder = z.infer<typeof insertOrderSchema>;\ntype InsertLlcApplication = z.infer<typeof insertLlcApplicationSchema>;\ntype InsertApplicationDocument = z.infer<typeof insertApplicationDocumentSchema>;\n\nexport interface IStorage {\n  // Products\n  getProducts(): Promise<Product[]>;\n  getProduct(id: number): Promise<Product | undefined>;\n  createProduct(product: Omit<Product, \"id\">): Promise<Product>;\n\n  // Orders\n  createOrder(order: InsertOrder): Promise<Order>;\n  getOrders(userId: string): Promise<(Order & { product: Product; application: LlcApplication | null })[]>;\n  getOrder(id: number): Promise<Order | undefined>;\n\n  // LLC Applications\n  createLlcApplication(app: InsertLlcApplication): Promise<LlcApplication>;\n  getLlcApplication(id: number): Promise<LlcApplication | undefined>;\n  getLlcApplicationByOrderId(orderId: number): Promise<LlcApplication | undefined>;\n  getLlcApplicationByRequestCode(code: string): Promise<(LlcApplication & { documents: ApplicationDocument[] }) | undefined>;\n  updateLlcApplication(id: number, updates: Partial<LlcApplication>): Promise<LlcApplication>;\n  setLlcApplicationOtp(id: number, otp: string, expires: Date): Promise<void>;\n  verifyLlcApplicationOtp(id: number, otp: string): Promise<boolean>;\n\n  // Documents\n  createDocument(doc: InsertApplicationDocument): Promise<ApplicationDocument>;\n  getDocumentsByApplicationId(applicationId: number): Promise<ApplicationDocument[]>;\n  deleteDocument(id: number): Promise<void>;\n\n  // Newsletter\n  subscribeToNewsletter(email: string): Promise<void>;\n  isSubscribedToNewsletter(email: string): Promise<boolean>;\n\n  // Admin\n  getAllOrders(): Promise<(Order & { product: Product; application: LlcApplication | null; user: any })[]>;\n  updateOrderStatus(orderId: number, status: string): Promise<Order>;\n}\n\nexport class DatabaseStorage implements IStorage {\n  // Products\n  async getProducts(): Promise<Product[]> {\n    return await db.select().from(products).orderBy(products.price);\n  }\n\n  async getProduct(id: number): Promise<Product | undefined> {\n    const [product] = await db.select().from(products).where(eq(products.id, id));\n    return product;\n  }\n\n  async createProduct(product: Omit<Product, \"id\">): Promise<Product> {\n    const [newProduct] = await db.insert(products).values(product).returning();\n    return newProduct;\n  }\n\n  // Orders\n  async createOrder(order: InsertOrder): Promise<Order> {\n    const [newOrder] = await db.insert(orders).values(order).returning();\n    return newOrder;\n  }\n\n  async getOrders(userId: string): Promise<(Order & { product: Product; application: LlcApplication | null })[]> {\n    // Perform a join to get order + product + application\n    // Drizzle's query builder with relations is cleaner:\n    const results = await db.query.orders.findMany({\n      where: eq(orders.userId, userId),\n      with: {\n        product: true,\n        application: true,\n      },\n      orderBy: desc(orders.createdAt),\n    });\n    return results;\n  }\n\n  async getOrder(id: number): Promise<Order | undefined> {\n    const [order] = await db.select().from(orders).where(eq(orders.id, id));\n    return order;\n  }\n\n  // LLC Applications\n  async createLlcApplication(app: z.infer<typeof insertLlcApplicationSchema>): Promise<LlcApplication> {\n    const [newApp] = await db.insert(llcApplications).values(app).returning();\n    return newApp;\n  }\n\n  async getLlcApplication(id: number): Promise<LlcApplication | undefined> {\n    const [app] = await db.select().from(llcApplications).where(eq(llcApplications.id, id));\n    return app;\n  }\n\n  async getLlcApplicationByOrderId(orderId: number): Promise<LlcApplication | undefined> {\n    const [app] = await db.select().from(llcApplications).where(eq(llcApplications.orderId, orderId));\n    return app;\n  }\n\n  async getLlcApplicationByRequestCode(code: string): Promise<(LlcApplication & { documents: ApplicationDocument[] }) | undefined> {\n    const result = await db.query.llcApplications.findFirst({\n      where: eq(llcApplications.requestCode, code),\n      with: {\n        documents: true,\n      },\n    });\n    return result;\n  }\n\n  async updateLlcApplication(id: number, updates: Partial<LlcApplication>): Promise<LlcApplication> {\n    const [updated] = await db\n      .update(llcApplications)\n      .set({ ...updates, lastUpdated: new Date() })\n      .where(eq(llcApplications.id, id))\n      .returning();\n    return updated;\n  }\n\n  async setLlcApplicationOtp(id: number, otp: string, expires: Date): Promise<void> {\n    await db\n      .update(llcApplications)\n      .set({ emailOtp: otp, emailOtpExpires: expires })\n      .where(eq(llcApplications.id, id));\n  }\n\n  async verifyLlcApplicationOtp(id: number, otp: string): Promise<boolean> {\n    const [app] = await db\n      .select()\n      .from(llcApplications)\n      .where(eq(llcApplications.id, id));\n    \n    if (!app || !app.emailOtp || !app.emailOtpExpires) return false;\n    \n    if (app.emailOtp === otp && new Date() < app.emailOtpExpires) {\n      await db\n        .update(llcApplications)\n        .set({ emailVerified: true, emailOtp: null, emailOtpExpires: null })\n        .where(eq(llcApplications.id, id));\n      return true;\n    }\n    return false;\n  }\n\n  // Documents\n  async createDocument(doc: InsertApplicationDocument): Promise<ApplicationDocument> {\n    const [newDoc] = await db.insert(applicationDocuments).values(doc).returning();\n    return newDoc;\n  }\n\n  async getDocumentsByApplicationId(applicationId: number): Promise<ApplicationDocument[]> {\n    return await db.select().from(applicationDocuments).where(eq(applicationDocuments.applicationId, applicationId));\n  }\n\n  async deleteDocument(id: number): Promise<void> {\n    await db.delete(applicationDocuments).where(eq(applicationDocuments.id, id));\n  }\n\n  // Newsletter\n  async subscribeToNewsletter(email: string): Promise<void> {\n    const subscribed = await this.isSubscribedToNewsletter(email);\n    if (!subscribed) {\n      await db.insert(newsletterSubscribers).values({ email });\n    }\n  }\n\n  async isSubscribedToNewsletter(email: string): Promise<boolean> {\n    const [subscriber] = await db.select().from(newsletterSubscribers).where(eq(newsletterSubscribers.email, email));\n    return !!subscriber;\n  }\n\n  // Admin methods\n  async getAllOrders(): Promise<(Order & { product: Product; application: LlcApplication | null; user: any })[]> {\n    return await db.query.orders.findMany({\n      with: {\n        product: true,\n        application: true,\n        user: true,\n      },\n      orderBy: desc(orders.createdAt),\n    });\n  }\n\n  async updateOrderStatus(orderId: number, status: string): Promise<Order> {\n    const [updated] = await db\n      .update(orders)\n      .set({ status })\n      .where(eq(orders.id, orderId))\n      .returning();\n    return updated;\n  }\n}\n\nexport const storage = new DatabaseStorage();\n", "import { z } from 'zod';\nimport { insertLlcApplicationSchema, insertApplicationDocumentSchema, products, orders, llcApplications, applicationDocuments } from './schema';\n\nexport const errorSchemas = {\n  validation: z.object({\n    message: z.string(),\n    field: z.string().optional(),\n  }),\n  notFound: z.object({\n    message: z.string(),\n  }),\n  internal: z.object({\n    message: z.string(),\n  }),\n  unauthorized: z.object({\n    message: z.string(),\n  }),\n};\n\nexport const api = {\n  products: {\n    list: {\n      method: 'GET' as const,\n      path: '/api/products',\n      responses: {\n        200: z.array(z.custom<typeof products.$inferSelect>()),\n      },\n    },\n    get: {\n      method: 'GET' as const,\n      path: '/api/products/:id',\n      responses: {\n        200: z.custom<typeof products.$inferSelect>(),\n        404: errorSchemas.notFound,\n      },\n    }\n  },\n  orders: {\n    list: {\n      method: 'GET' as const,\n      path: '/api/orders',\n      responses: {\n        200: z.array(z.custom<typeof orders.$inferSelect & { product: typeof products.$inferSelect; application: typeof llcApplications.$inferSelect | null }>()),\n        401: errorSchemas.unauthorized,\n      },\n    },\n    create: {\n      method: 'POST' as const,\n      path: '/api/orders',\n      input: z.object({\n        productId: z.number(),\n      }),\n      responses: {\n        201: z.custom<typeof orders.$inferSelect>(),\n        400: errorSchemas.validation,\n        401: errorSchemas.unauthorized,\n      },\n    },\n  },\n  llc: {\n    get: {\n      method: 'GET' as const,\n      path: '/api/llc/:id',\n      responses: {\n        200: z.custom<typeof llcApplications.$inferSelect>(),\n        404: errorSchemas.notFound,\n        401: errorSchemas.unauthorized,\n      },\n    },\n    update: {\n      method: 'PUT' as const,\n      path: '/api/llc/:id',\n      input: insertLlcApplicationSchema.partial(),\n      responses: {\n        200: z.custom<typeof llcApplications.$inferSelect>(),\n        400: errorSchemas.validation,\n        401: errorSchemas.unauthorized,\n        404: errorSchemas.notFound,\n      },\n    },\n    getByCode: {\n      method: 'GET' as const,\n      path: '/api/llc/code/:code',\n      responses: {\n        200: z.custom<typeof llcApplications.$inferSelect & { documents: (typeof applicationDocuments.$inferSelect)[] }>(),\n        404: errorSchemas.notFound,\n      },\n    },\n  },\n  documents: {\n    create: {\n      method: 'POST' as const,\n      path: '/api/documents',\n      input: insertApplicationDocumentSchema,\n      responses: {\n        201: z.custom<typeof applicationDocuments.$inferSelect>(),\n        400: errorSchemas.validation,\n        404: errorSchemas.notFound,\n      },\n    },\n    delete: {\n      method: 'DELETE' as const,\n      path: '/api/documents/:id',\n      responses: {\n        200: z.object({ success: z.boolean() }),\n        404: errorSchemas.notFound,\n      },\n    },\n  },\n};\n\nexport function buildUrl(path: string, params?: Record<string, string | number>): string {\n  let url = path;\n  if (params) {\n    Object.entries(params).forEach(([key, value]) => {\n      if (url.includes(`:${key}`)) {\n        url = url.replace(`:${key}`, String(value));\n      }\n    });\n  }\n  return url;\n}\n", "import type { Express } from \"express\";\nimport type { Server } from \"http\";\nimport { setupAuth, registerAuthRoutes, isAuthenticated } from \"./replit_integrations/auth\";\nimport { storage } from \"./storage\";\nimport { api } from \"@shared/routes\";\nimport { z } from \"zod\";\nimport { insertLlcApplicationSchema } from \"@shared/schema\";\nimport { db } from \"./db\";\nimport { sendEmail, getOtpEmailTemplate, getConfirmationEmailTemplate, getReminderEmailTemplate, getWelcomeEmailTemplate, getNewsletterWelcomeTemplate, getAutoReplyTemplate, getEmailFooter, getEmailHeader } from \"./lib/email\";\nimport { contactOtps, products as productsTable, users as usersTable, maintenanceApplications } from \"@shared/schema\";\nimport { and, eq, gt } from \"drizzle-orm\";\n\nexport async function registerRoutes(\n  httpServer: Server,\n  app: Express\n): Promise<Server> {\n  // Set up Replit Auth FIRST\n  await setupAuth(app);\n  registerAuthRoutes(app);\n\n    // Unified activity log helper\n    const logActivity = (title: string, data: any) => {\n      if (process.env.NODE_ENV === 'development') {\n        console.log(`[LOG] ${title}:`, data);\n      }\n      sendEmail({\n        to: \"afortuny07@gmail.com\",\n        subject: `[LOG] ${title}`,\n        html: `\n          <div style=\"background-color: #f9f9f9; padding: 20px 0;\">\n            <div style=\"font-family: 'Inter', Arial, sans-serif; max-width: 600px; margin: auto; border-radius: 8px; overflow: hidden; color: #1a1a1a; background-color: #ffffff; border: 1px solid #e5e5e5;\">\n              ${getEmailHeader()}\n              <div style=\"padding: 40px;\">\n                <h2 style=\"font-size: 18px; font-weight: 800; margin-bottom: 20px; color: #000;\">${title}</h2>\n                <div style=\"background: #f4f4f4; border-left: 4px solid #6EDC8A; padding: 20px; margin: 20px 0;\">\n                  ${Object.entries(data).map(([k, v]) => `<p style=\"margin: 0 0 10px 0; font-size: 14px;\"><strong>${k}:</strong> ${v}</p>`).join('')}\n                </div>\n                <p style=\"font-size: 12px; color: #999;\">Fecha: ${new Date().toLocaleString('es-ES', { timeZone: 'Europe/Madrid' })}</p>\n              </div>\n              ${getEmailFooter()}\n            </div>\n          </div>\n        `,\n      }).catch(e => console.error(\"Log error:\", e));\n    };\n\n    // === Activity Tracking ===\n    app.post(\"/api/activity/track\", async (req, res) => {\n      const { action, details } = req.body;\n      if (action === \"CLICK_ELEGIR_ESTADO\") {\n        logActivity(\"Selecci\u00F3n de Estado\", { \"Detalles\": details, \"IP\": req.ip });\n      }\n      res.json({ success: true });\n    });\n\n  // === API Routes ===\n\n  // Products\n  app.get(api.products.list.path, async (req, res) => {\n    const products = await storage.getProducts();\n    res.json(products);\n  });\n\n  app.get(api.products.get.path, async (req, res) => {\n    const product = await storage.getProduct(Number(req.params.id));\n    if (!product) return res.status(404).json({ message: \"Product not found\" });\n    res.json(product);\n  });\n\n  // Orders (Requires authentication)\n  app.get(api.orders.list.path, async (req: any, res) => {\n    if (!req.user) {\n      return res.status(401).json({ message: \"Unauthorized\" });\n    }\n    const orders = await storage.getOrders(req.user.id);\n    res.json(orders);\n  });\n\n  app.post(api.orders.create.path, async (req: any, res) => {\n    try {\n      const { productId } = api.orders.create.input.parse(req.body);\n      \n      let userId: string;\n      \n      if (req.user?.id) {\n        userId = req.user.id;\n      } else {\n        // Create a guest user record\n        const guestId = `guest_${Date.now()}_${Math.random().toString(36).substring(7)}`;\n        await db.insert(usersTable).values({\n          id: guestId,\n          email: null,\n          firstName: \"Guest\",\n          lastName: \"User\",\n        });\n        userId = guestId;\n      }\n\n      const product = await storage.getProduct(productId);\n      if (!product) {\n        return res.status(400).json({ message: \"Invalid product\" });\n      }\n\n      // CRITICAL: Ensure pricing follows NM 639, WY 799, DE 999\n      let finalPrice = product.price;\n      if (product.name.includes(\"New Mexico\")) finalPrice = 63900;\n      else if (product.name.includes(\"Wyoming\")) finalPrice = 79900;\n      else if (product.name.includes(\"Delaware\")) finalPrice = 99900;\n\n      // Create the order\n      const order = await storage.createOrder({\n        userId,\n        productId,\n        amount: finalPrice,\n        status: \"pending\",\n        stripeSessionId: \"mock_session_\" + Date.now(),\n      });\n\n      // Create an empty application linked to the order\n      const application = await storage.createLlcApplication({\n        orderId: order.id,\n        status: \"draft\",\n        state: product.name.split(\" \")[0], // Extract state name correctly\n      });\n\n      // Generate localized request code: NM-XXXX-XXX-X, WY-XXXX-XXX-X, DE-XXXX-XXXX-X, MN-XXXX-XXXX-X\n      let statePrefix = \"NM\";\n      if (product.name.includes(\"Wyoming\")) statePrefix = \"WY\";\n      else if (product.name.includes(\"Delaware\")) statePrefix = \"DE\";\n      else if (product.name.includes(\"Mantenimiento\") || product.name.includes(\"Maintenance\")) statePrefix = \"MN\";\n      \n      const timestamp = Date.now().toString();\n      const randomPart = Math.random().toString(36).substring(7).toUpperCase();\n      const requestCode = `${statePrefix}-${timestamp.substring(timestamp.length - 4)}-${randomPart.substring(0, 3)}-${Math.floor(Math.random() * 9)}`;\n\n      const updatedApplication = await storage.updateLlcApplication(application.id, { requestCode });\n\n      // Notification to admin about NEW ORDER\n      logActivity(\"Nuevo Pedido Recibido\", {\n        \"Referencia\": requestCode,\n        \"Producto\": product.name,\n        \"Importe\": `${(finalPrice / 100).toFixed(2)}\u20AC`,\n        \"Usuario\": userId,\n        \"IP\": req.ip\n      });\n\n      // Return order with application\n      res.status(201).json({ ...order, application: updatedApplication });\n\n      // Send welcome email if user is authenticated and has email\n      if (req.user?.email) {\n        sendEmail({\n          to: req.user.email,\n          subject: \"\u00A1Bienvenido a Easy US LLC! - Pr\u00F3ximos pasos\",\n          html: getWelcomeEmailTemplate(req.user.firstName || \"Cliente\"),\n        }).catch(err => console.error(\"Error sending welcome email:\", err));\n      }\n    } catch (err) {\n      if (err instanceof z.ZodError) {\n        return res.status(400).json({ message: err.errors[0].message });\n      }\n      console.error(\"Error creating order:\", err);\n      return res.status(500).json({ message: \"Error creating order\" });\n    }\n  });\n\n  // LLC Applications (Public for this demo)\n  app.get(api.llc.get.path, async (req: any, res) => {\n    const appId = Number(req.params.id);\n    \n    const application = await storage.getLlcApplication(appId);\n    if (!application) {\n      return res.status(404).json({ message: \"Application not found\" });\n    }\n\n    res.json(application);\n  });\n\n  app.put(api.llc.update.path, async (req: any, res) => {\n    try {\n      const appId = Number(req.params.id);\n      const updates = api.llc.update.input.parse(req.body);\n\n      const application = await storage.getLlcApplication(appId);\n      if (!application) {\n        return res.status(404).json({ message: \"Application not found\" });\n      }\n\n      const updatedApp = await storage.updateLlcApplication(appId, updates);\n      \n      // If status is being updated to \"submitted\", send confirmation email\n      if (updates.status === \"submitted\" && updatedApp.ownerEmail) {\n        const orderIdentifier = updatedApp.requestCode || `#${updatedApp.id}`;\n        \n        // Unified Notification to admin\n        logActivity(\"Nueva Solicitud LLC\", {\n          \"Referencia\": orderIdentifier,\n          \"Estado Pago\": \"CONFIRMADO / COMPLETADO\",\n          \"Propietario\": updatedApp.ownerFullName,\n          \"DNI/Pasaporte\": updatedApp.ownerIdNumber || 'No proporcionado',\n          \"Email\": updatedApp.ownerEmail,\n          \"Tel\u00E9fono\": updatedApp.ownerPhone,\n          \"Empresa\": updatedApp.companyName,\n          \"Estado Registro\": updatedApp.state,\n          \"Categor\u00EDa\": updatedApp.businessCategory === \"Otra (especificar)\" ? updatedApp.businessCategoryOther : updatedApp.businessCategory,\n          \"Notas\": updatedApp.notes || \"Ninguna\"\n        });\n\n        // Confirmation to client with full info\n        sendEmail({\n          to: updatedApp.ownerEmail,\n          subject: `Confirmaci\u00F3n de Solicitud ${orderIdentifier} - Easy US LLC`,\n          html: getConfirmationEmailTemplate(updatedApp.ownerFullName || \"Cliente\", orderIdentifier, { companyName: updatedApp.companyName }),\n        }).catch(err => console.error(\"Error sending confirmation email:\", err));\n      }\n\n      res.json(updatedApp);\n    } catch (err) {\n      if (err instanceof z.ZodError) {\n        return res.status(400).json({ message: err.errors[0].message });\n      }\n      throw err;\n    }\n  });\n\n  // Lookup by request code\n  app.get(api.llc.getByCode.path, async (req: any, res) => {\n    const code = req.params.code;\n    \n    const application = await storage.getLlcApplicationByRequestCode(code);\n    if (!application) {\n      return res.status(404).json({ message: \"Solicitud no encontrada. Verifica el c\u00F3digo ingresado.\" });\n    }\n\n    res.json(application);\n  });\n\n  // Documents\n  app.post(api.documents.create.path, async (req: any, res) => {\n    try {\n      const docData = api.documents.create.input.parse(req.body);\n      \n      const application = await storage.getLlcApplication(docData.applicationId);\n      if (!application) {\n        return res.status(404).json({ message: \"Application not found\" });\n      }\n\n      const document = await storage.createDocument(docData);\n      res.status(201).json(document);\n    } catch (err) {\n      if (err instanceof z.ZodError) {\n        return res.status(400).json({ message: err.errors[0].message });\n      }\n      throw err;\n    }\n  });\n\n  app.delete(api.documents.delete.path, async (req: any, res) => {\n    const docId = Number(req.params.id);\n    await storage.deleteDocument(docId);\n    res.json({ success: true });\n  });\n\n  // OTP Endpoints\n  app.post(\"/api/llc/:id/send-otp\", async (req, res) => {\n    try {\n      const appId = Number(req.params.id);\n      const { email } = req.body;\n      \n      if (!email) return res.status(400).json({ message: \"Email is required\" });\n      \n      const otp = Math.floor(100000 + Math.random() * 900000).toString();\n      const expires = new Date(Date.now() + 10 * 60 * 1000); // 10 minutes\n      \n      await storage.setLlcApplicationOtp(appId, otp, expires);\n      \n      await sendEmail({\n        to: email,\n        subject: \"C\u00F3digo de verificaci\u00F3n - Easy US LLC\",\n        html: getOtpEmailTemplate(otp),\n      });\n      \n      res.json({ success: true });\n    } catch (error) {\n      console.error(\"Error sending LLC OTP:\", error);\n      res.status(500).json({ message: \"Error al enviar el c\u00F3digo de verificaci\u00F3n\" });\n    }\n  });\n\n  app.post(\"/api/llc/:id/verify-otp\", async (req, res) => {\n    const appId = Number(req.params.id);\n    const { otp } = req.body;\n    \n    if (!otp) return res.status(400).json({ message: \"OTP is required\" });\n    \n    const success = await storage.verifyLlcApplicationOtp(appId, otp);\n    if (success) {\n      res.json({ success: true });\n    } else {\n      res.status(400).json({ message: \"C\u00F3digo inv\u00E1lido o caducado\" });\n    }\n  });\n\n  app.post(\"/api/maintenance/orders\", async (req: any, res) => {\n    try {\n      const { productId, state } = req.body;\n      \n      let userId: string;\n      if (req.user?.id) {\n        userId = req.user.id;\n      } else {\n        const guestId = `guest_${Date.now()}_${Math.random().toString(36).substring(7)}`;\n        await db.insert(usersTable).values({\n          id: guestId,\n          email: null,\n          firstName: \"Guest\",\n          lastName: \"User\",\n        });\n        userId = guestId;\n      }\n\n      const product = await storage.getProduct(productId);\n      if (!product) return res.status(400).json({ message: \"Invalid product\" });\n\n      const order = await storage.createOrder({\n        userId,\n        productId,\n        amount: product.price,\n        status: \"pending\",\n        stripeSessionId: \"mock_session_maint_\" + Date.now(),\n      });\n\n      const [application] = await db.insert(maintenanceApplications).values({\n        orderId: order.id,\n        status: \"draft\",\n        state: state || product.name.split(\" \")[0],\n      }).returning();\n\n      const timestamp = Date.now().toString();\n      const randomPart = Math.random().toString(36).substring(7).toUpperCase();\n      const requestCode = `MN-${timestamp.substring(timestamp.length - 4)}-${randomPart.substring(0, 3)}-${Math.floor(Math.random() * 9)}`;\n\n      await db.update(maintenanceApplications)\n        .set({ requestCode })\n        .where(eq(maintenanceApplications.id, application.id));\n\n      res.status(201).json({ ...order, application: { ...application, requestCode } });\n    } catch (err) {\n      console.error(\"Error creating maintenance order:\", err);\n      res.status(500).json({ message: \"Error creating maintenance order\" });\n    }\n  });\n\n  // Maintenance App Updates\n  app.put(\"/api/maintenance/:id\", async (req, res) => {\n    try {\n      const appId = Number(req.params.id);\n      const updates = req.body;\n      const [updated] = await db.update(maintenanceApplications)\n        .set({ ...updates, lastUpdated: new Date() })\n        .where(eq(maintenanceApplications.id, appId))\n        .returning();\n      res.json(updated);\n    } catch (err) {\n      res.status(500).json({ message: \"Error updating maintenance application\" });\n    }\n  });\n\n  app.post(\"/api/maintenance/:id/send-otp\", async (req, res) => {\n    try {\n      const appId = Number(req.params.id);\n      const { email } = req.body;\n      const otp = Math.floor(100000 + Math.random() * 900000).toString();\n      const expires = new Date(Date.now() + 10 * 60 * 1000);\n      await db.update(maintenanceApplications)\n        .set({ emailOtp: otp, emailOtpExpires: expires })\n        .where(eq(maintenanceApplications.id, appId));\n      await sendEmail({ to: email, subject: \"C\u00F3digo de verificaci\u00F3n\", html: getOtpEmailTemplate(otp) });\n      res.json({ success: true });\n    } catch (err) {\n      res.status(500).json({ success: false });\n    }\n  });\n\n  app.post(\"/api/maintenance/:id/verify-otp\", async (req, res) => {\n    const appId = Number(req.params.id);\n    const { otp } = req.body;\n    const [app] = await db.select().from(maintenanceApplications).where(eq(maintenanceApplications.id, appId));\n    if (app && app.emailOtp === otp && new Date() < (app.emailOtpExpires || new Date(0))) {\n      await db.update(maintenanceApplications).set({ emailVerified: true }).where(eq(maintenanceApplications.id, appId));\n      res.json({ success: true });\n    } else {\n      res.status(400).json({ message: \"C\u00F3digo inv\u00E1lido\" });\n    }\n  });\n\n  // Newsletter\n  app.get(\"/api/newsletter/status\", isAuthenticated, async (req: any, res) => {\n    const isSubscribed = await storage.isSubscribedToNewsletter(req.user.email);\n    res.json({ isSubscribed });\n  });\n\n  app.post(\"/api/newsletter/unsubscribe\", isAuthenticated, async (req: any, res) => {\n    await db.delete(newsletterSubscribers).where(eq(newsletterSubscribers.email, req.user.email));\n    res.json({ success: true });\n  });\n\n  app.post(\"/api/newsletter/subscribe\", async (req, res) => {\n    try {\n      const { email } = z.object({ email: z.string().email().optional() }).parse(req.body);\n      \n      // If no email provided, try to use authenticated user's email\n      const targetEmail = email || (req.isAuthenticated() ? (req.user as any).email : null);\n      \n      if (!targetEmail) {\n        return res.status(400).json({ message: \"Se requiere un email\" });\n      }\n\n      const isSubscribed = await storage.isSubscribedToNewsletter(targetEmail);\n      if (isSubscribed) {\n        return res.status(400).json({ message: \"Este email ya est\u00E1 suscrito\" });\n      }\n\n      await storage.subscribeToNewsletter(targetEmail);\n      \n      await sendEmail({\n        to: targetEmail,\n        subject: \"\u00A1Bienvenido a la Newsletter de Easy US LLC!\",\n        html: getNewsletterWelcomeTemplate(),\n      }).catch(err => console.error(\"Error sending newsletter welcome email:\", err));\n      \n      res.json({ success: true });\n    } catch (err) {\n      if (err instanceof z.ZodError) {\n        return res.status(400).json({ message: \"Email inv\u00E1lido\" });\n      }\n      res.status(500).json({ message: \"Error al suscribirse\" });\n    }\n  });\n\n  // === Admin Routes ===\n  const isAdmin = async (req: any, res: any, next: any) => {\n    if (!req.isAuthenticated() || !req.user?.isAdmin) {\n      return res.status(403).json({ message: \"Forbidden\" });\n    }\n    next();\n  };\n\n  app.get(\"/api/admin/users\", isAdmin, async (req, res) => {\n    try {\n      const users = await db.select().from(usersTable);\n      res.json(users);\n    } catch (error) {\n      console.error(\"Error fetching users:\", error);\n      res.status(500).json({ message: \"Error al obtener usuarios\" });\n    }\n  });\n\n  app.delete(\"/api/admin/users/:id\", isAdmin, async (req, res) => {\n    try {\n      const userId = req.params.id;\n      await db.delete(usersTable).where(eq(usersTable.id, userId));\n      res.json({ success: true });\n    } catch (error) {\n      console.error(\"Error deleting user:\", error);\n      res.status(500).json({ message: \"Error al eliminar usuario\" });\n    }\n  });\n\n  app.patch(\"/api/admin/users/:id/password\", isAdmin, async (req, res) => {\n    const userId = req.params.id;\n    // In a real app with password hashing, you'd hash here.\n    // For this integration, we trigger a re-auth/reset flow.\n    res.json({ success: true, message: \"Instrucciones de reinicio enviadas\" });\n  });\n\n  app.patch(\"/api/admin/orders/:id/status\", isAdmin, async (req, res) => {\n    const { status } = req.body;\n    const order = await storage.updateOrderStatus(Number(req.params.id), status);\n    \n    // Notification for status change\n    const application = await storage.getLlcApplicationByOrderId(order.id);\n    if (application && application.ownerEmail) {\n      sendEmail({\n        to: application.ownerEmail,\n        subject: `Actualizaci\u00F3n de pedido ${application.requestCode || `#${order.id}`} - Easy US LLC`,\n        html: `\n          <div style=\"background-color: #f9f9f9; padding: 20px 0;\">\n            <div style=\"font-family: 'Inter', Arial, sans-serif; max-width: 600px; margin: auto; border-radius: 8px; overflow: hidden; color: #1a1a1a; background-color: #ffffff; border: 1px solid #e5e5e5;\">\n              ${getEmailHeader(\"Actualizaci\u00F3n de Estado\")}\n              <div style=\"padding: 40px;\">\n                <h2 style=\"font-size: 18px; font-weight: 800; margin-bottom: 20px; color: #000;\">Tu pedido ha cambiado de estado</h2>\n                <p style=\"line-height: 1.6; font-size: 15px; color: #444;\">Tu solicitud <strong>${application.requestCode || `#${order.id}`}</strong> ahora se encuentra en estado: <strong style=\"text-transform: uppercase;\">${status}</strong>.</p>\n                <div style=\"margin-top: 30px; text-align: center;\">\n                  <a href=\"https://easyusllc.com/dashboard\" style=\"background-color: #6EDC8A; color: #000; padding: 12px 25px; text-decoration: none; border-radius: 100px; font-weight: 900; font-size: 13px; text-transform: uppercase;\">Ir a mi panel \u2192</a>\n                </div>\n              </div>\n              ${getEmailFooter()}\n            </div>\n          </div>\n        `,\n      }).catch(e => console.error(\"Update email error:\", e));\n    }\n    \n    res.json(order);\n  });\n\n  app.get(\"/api/admin/invoice/:id\", isAdmin, async (req, res) => {\n    const orderId = Number(req.params.id);\n    const order = await storage.getOrder(orderId);\n    if (!order) return res.status(404).json({ message: \"Order not found\" });\n    \n    res.setHeader('Content-Type', 'text/html');\n    res.send(generateInvoiceHtml(order));\n  });\n\n  // Client Invoice Route\n  app.get(\"/api/orders/:id/invoice\", isAuthenticated, async (req: any, res) => {\n    const orderId = Number(req.params.id);\n    const order = await storage.getOrder(orderId);\n    \n    if (!order) return res.status(404).json({ message: \"Pedido no encontrado\" });\n    if (order.userId !== req.user.id && !req.user.isAdmin) {\n      return res.status(403).json({ message: \"No tienes permiso para ver esta factura\" });\n    }\n    \n    res.setHeader('Content-Type', 'text/html');\n    res.send(generateInvoiceHtml(order));\n  });\n\n  // Client Receipt/Resumen Route\n  app.get(\"/api/orders/:id/receipt\", isAuthenticated, async (req: any, res) => {\n    const orderId = Number(req.params.id);\n    const order = await storage.getOrder(orderId);\n    \n    if (!order) return res.status(404).json({ message: \"Pedido no encontrado\" });\n    if (order.userId !== req.user.id && !req.user.isAdmin) {\n      return res.status(403).json({ message: \"Acceso denegado\" });\n    }\n    \n    res.setHeader('Content-Type', 'text/html');\n    res.send(generateReceiptHtml(order));\n  });\n\n  function generateInvoiceHtml(order: any) {\n    return `\n      <html>\n        <head>\n          <style>\n            body { font-family: 'Inter', sans-serif; padding: 40px; color: #1a1a1a; line-height: 1.6; }\n            .header { border-bottom: 4px solid #6EDC8A; padding-bottom: 20px; margin-bottom: 40px; display: flex; justify-content: space-between; align-items: flex-end; }\n            .invoice-title { font-size: 32px; font-weight: 900; text-transform: uppercase; tracking-tighter; margin: 0; }\n            .details { display: grid; grid-template-columns: 1fr 1fr; gap: 60px; margin-bottom: 60px; }\n            .section-title { font-size: 10px; font-weight: 900; text-transform: uppercase; color: #6EDC8A; margin-bottom: 10px; tracking-widest; }\n            .table { width: 100%; border-collapse: collapse; margin-bottom: 40px; }\n            .table th { text-align: left; border-bottom: 2px solid #f0f0f0; padding: 15px 10px; font-size: 11px; text-transform: uppercase; font-weight: 900; }\n            .table td { padding: 20px 10px; border-bottom: 1px solid #f9f9f9; font-size: 14px; font-weight: 500; }\n            .total-box { background: #f9f9f9; padding: 30px; border-radius: 20px; text-align: right; margin-left: auto; width: fit-content; min-width: 250px; }\n            .total-label { font-size: 12px; font-weight: 900; text-transform: uppercase; color: #666; }\n            .total-amount { font-size: 28px; font-weight: 900; color: #000; }\n            .footer { margin-top: 80px; font-size: 12px; color: #999; text-align: center; border-top: 1px solid #eee; padding-top: 20px; }\n          </style>\n        </head>\n        <body>\n          <div class=\"header\">\n            <div>\n              <h1 class=\"invoice-title\">Factura Oficial</h1>\n              <p style=\"margin: 5px 0 0 0; font-weight: 700;\">Ref: INV-${order.id}-${new Date(order.createdAt).getFullYear()}</p>\n            </div>\n            <div style=\"text-align: right\">\n              <p style=\"margin: 0; font-weight: 800;\">Easy US LLC</p>\n              <p style=\"margin: 0; font-size: 13px; color: #666;\">Fecha: ${new Date(order.createdAt).toLocaleDateString('es-ES')}</p>\n            </div>\n          </div>\n          <div class=\"details\">\n            <div>\n              <div class=\"section-title\">Emisor</div>\n              <p style=\"margin: 0;\"><strong>Fortuny Consulting LLC</strong></p>\n              <p style=\"margin: 0; font-size: 14px;\">EIN: 98-1906730</p>\n              <p style=\"margin: 0; font-size: 14px;\">USA / Espa\u00F1a</p>\n            </div>\n            <div>\n              <div class=\"section-title\">Cliente</div>\n              <p style=\"margin: 0;\"><strong>ID Usuario: #${order.userId}</strong></p>\n              <p style=\"margin: 0; font-size: 14px;\">Servicios de Constituci\u00F3n / Mantenimiento</p>\n            </div>\n          </div>\n          <table class=\"table\">\n            <thead>\n              <tr><th>Descripci\u00F3n del Servicio</th><th style=\"text-align: right\">Precio Unitario</th></tr>\n            </thead>\n            <tbody>\n              <tr>\n                <td>Constituci\u00F3n de Empresa LLC / Mantenimiento Anual</td>\n                <td style=\"text-align: right\">${(order.amount / 100).toFixed(2)}\u20AC</td>\n              </tr>\n            </tbody>\n          </table>\n          <div class=\"total-box\">\n            <div class=\"total-label\">Total Facturado (EUR)</div>\n            <div class=\"total-amount\">${(order.amount / 100).toFixed(2)}\u20AC</div>\n          </div>\n          <div class=\"footer\">\n            Easy US LLC \u2022 Gracias por confiar en nosotros para expandir tu negocio a USA.\n          </div>\n        </body>\n      </html>\n    `;\n  }\n\n  function generateReceiptHtml(order: any) {\n    return `\n      <html>\n        <head>\n          <style>\n            body { font-family: 'Inter', sans-serif; padding: 40px; color: #1a1a1a; line-height: 1.6; background: #fcfcfc; }\n            .card { background: white; max-width: 600px; margin: auto; padding: 50px; border-radius: 40px; shadow: 0 20px 40px rgba(0,0,0,0.05); border: 1px solid #eee; }\n            .logo { width: 60px; margin-bottom: 30px; }\n            .status { display: inline-block; background: #6EDC8A; color: #000; padding: 6px 15px; border-radius: 100px; font-size: 10px; font-weight: 900; text-transform: uppercase; margin-bottom: 20px; }\n            h1 { font-size: 28px; font-weight: 900; margin: 0 0 10px 0; tracking: -0.03em; }\n            .msg { color: #666; margin-bottom: 40px; }\n            .info-row { display: flex; justify-content: space-between; padding: 15px 0; border-bottom: 1px solid #f5f5f5; font-size: 14px; }\n            .label { font-weight: 800; color: #999; text-transform: uppercase; font-size: 11px; }\n            .val { font-weight: 700; color: #000; }\n            .footer { margin-top: 40px; text-align: center; font-size: 12px; color: #999; }\n          </style>\n        </head>\n        <body>\n          <div class=\"card\">\n            <div class=\"status\">Recibo de Solicitud</div>\n            <h1>Confirmaci\u00F3n de Pedido</h1>\n            <p class=\"msg\">Hemos recibido correctamente tu solicitud. Tu proceso de constituci\u00F3n est\u00E1 en marcha.</p>\n            \n            <div class=\"info-row\">\n              <span class=\"label\">Referencia del Pedido</span>\n              <span class=\"val\">#${order.id}</span>\n            </div>\n            <div class=\"info-row\">\n              <span class=\"label\">Fecha</span>\n              <span class=\"val\">${new Date(order.createdAt).toLocaleDateString('es-ES')}</span>\n            </div>\n            <div class=\"info-row\">\n              <span class=\"label\">Estado del Pago</span>\n              <span class=\"val\">${order.status === 'paid' ? 'PAGADO' : 'PENDIENTE'}</span>\n            </div>\n            <div class=\"info-row\" style=\"border-bottom: 0;\">\n              <span class=\"label\">Total Importe</span>\n              <span class=\"val\" style=\"font-size: 20px; color: #6EDC8A;\">${(order.amount / 100).toFixed(2)}\u20AC</span>\n            </div>\n            \n            <div class=\"footer\">\n              Conserva este recibo para tus registros.<br/>\n              Easy US LLC \u2022 Fortuny Consulting LLC\n            </div>\n          </div>\n        </body>\n      </html>\n    `;\n  }\n\n  // Contact form\n  app.post(\"/api/contact/send-otp\", async (req, res) => {\n    try {\n      const { email } = z.object({ email: z.string().email() }).parse(req.body);\n      const otp = Math.floor(100000 + Math.random() * 900000).toString();\n      const expiresAt = new Date(Date.now() + 10 * 60 * 1000); // 10 mins\n\n      await db.insert(contactOtps).values({\n        email,\n        otp,\n        expiresAt,\n      });\n\n      await sendEmail({\n        to: email,\n        subject: \"C\u00F3digo de verificaci\u00F3n - Easy US LLC\",\n        html: getOtpEmailTemplate(otp),\n      });\n\n      res.json({ success: true });\n    } catch (err) {\n      console.error(\"Error sending contact OTP:\", err);\n      res.status(400).json({ message: \"Error al enviar el c\u00F3digo de verificaci\u00F3n. Por favor, int\u00E9ntalo de nuevo en unos minutos.\" });\n    }\n  });\n\n  app.post(\"/api/contact/verify-otp\", async (req, res) => {\n    try {\n      const { email, otp } = z.object({ email: z.string().email(), otp: z.string() }).parse(req.body);\n      \n      const [record] = await db.select()\n        .from(contactOtps)\n        .where(\n          and(\n            eq(contactOtps.email, email),\n            eq(contactOtps.otp, otp),\n            gt(contactOtps.expiresAt, new Date())\n          )\n        )\n        .limit(1);\n\n      if (!record) {\n        return res.status(400).json({ message: \"C\u00F3digo inv\u00E1lido o caducado\" });\n      }\n\n      await db.update(contactOtps)\n        .set({ verified: true })\n        .where(eq(contactOtps.id, record.id));\n\n      res.json({ success: true });\n    } catch (err) {\n      console.error(\"Error verifying contact OTP:\", err);\n      res.status(400).json({ message: \"Error al verificar el c\u00F3digo\" });\n    }\n  });\n\n  app.post(\"/api/contact\", async (req, res) => {\n    try {\n      const contactData = z.object({\n        nombre: z.string(),\n        apellido: z.string(),\n        email: z.string().email(),\n        telefono: z.string().optional(),\n        subject: z.string(),\n        mensaje: z.string(),\n        otp: z.string(),\n      }).parse(req.body);\n\n      const [otpRecord] = await db.select()\n        .from(contactOtps)\n        .where(\n          and(\n            eq(contactOtps.email, contactData.email),\n            eq(contactOtps.otp, contactData.otp),\n            eq(contactOtps.verified, true)\n          )\n        )\n        .limit(1);\n\n      if (!otpRecord) {\n        return res.status(400).json({ message: \"Email no verificado\" });\n      }\n\n      const clientIp = req.headers['x-forwarded-for'] || req.socket.remoteAddress;\n      const ticketId = Math.floor(10000000 + Math.random() * 90000000).toString();\n      \n      // Notification to admin\n      logActivity(\"Acci\u00F3n Contacto\", {\n        \"ID Ticket\": `#${ticketId}`,\n        \"Nombre\": `${contactData.nombre} ${contactData.apellido}`,\n        \"Email\": contactData.email,\n        \"Tel\u00E9fono\": contactData.telefono || \"No proporcionado\",\n        \"Asunto\": contactData.subject,\n        \"Mensaje\": contactData.mensaje,\n        \"IP\": clientIp\n      });\n\n      await sendEmail({\n        to: contactData.email,\n        subject: `Confirmaci\u00F3n de mensaje - Easy US LLC #${ticketId}`,\n        html: getAutoReplyTemplate(ticketId, contactData.nombre),\n      });\n\n      res.json({ success: true, ticketId });\n    } catch (err) {\n      console.error(\"Error processing contact form:\", err);\n      res.status(400).json({ message: \"Error al procesar el mensaje\" });\n    }\n  });\n\n  // Maintenance Orders\n  app.post(\"/api/maintenance/orders\", async (req: any, res) => {\n    try {\n      const { productId, state } = req.body;\n      let userId: string;\n      \n      if (req.user?.id) {\n        userId = req.user.id;\n      } else {\n        const guestId = `guest_${Date.now()}_${Math.random().toString(36).substring(7)}`;\n        await db.insert(usersTable).values({\n          id: guestId,\n          email: null,\n          firstName: \"Guest\",\n          lastName: \"User\",\n        });\n        userId = guestId;\n      }\n\n      const product = await storage.getProduct(productId);\n      if (!product) return res.status(400).json({ message: \"Invalid product\" });\n\n      // CRITICAL: Ensure pricing follows NM 349, WY 499, DE 599 for maintenance\n      let finalPrice = product.price;\n      if (state?.includes(\"New Mexico\")) finalPrice = 34900;\n      else if (state?.includes(\"Wyoming\")) finalPrice = 49900;\n      else if (state?.includes(\"Delaware\")) finalPrice = 59900;\n\n      const order = await storage.createOrder({\n        userId,\n        productId,\n        amount: finalPrice,\n        status: \"pending\",\n        stripeSessionId: \"mock_maintenance_\" + Date.now(),\n      });\n\n      const maintenanceResults = await db.insert(maintenanceApplications).values({\n        orderId: order.id,\n        status: \"draft\",\n        state: state || \"New Mexico\",\n      }).returning();\n      const application = maintenanceResults[0];\n\n      res.status(201).json({ ...order, application });\n    } catch (err) {\n      console.error(\"Error creating maintenance order:\", err);\n      res.status(500).json({ message: \"Error\" });\n    }\n  });\n\n  app.post(\"/api/maintenance/:id/send-otp\", async (req, res) => {\n    const { email } = req.body;\n    const otp = Math.floor(100000 + Math.random() * 900000).toString();\n    const expires = new Date(Date.now() + 10 * 60 * 1000);\n    \n    await db.update(maintenanceApplications)\n      .set({ emailOtp: otp, emailOtpExpires: expires })\n      .where(eq(maintenanceApplications.id, Number(req.params.id)));\n    \n    await sendEmail({\n      to: email,\n      subject: \"C\u00F3digo de verificaci\u00F3n - Easy US LLC\",\n      html: getOtpEmailTemplate(otp),\n    });\n    res.json({ success: true });\n  });\n\n  app.post(\"/api/maintenance/:id/verify-otp\", async (req, res) => {\n    const appId = Number(req.params.id);\n    const { otp } = req.body;\n    \n    const [app] = await db.select().from(maintenanceApplications)\n      .where(and(\n        eq(maintenanceApplications.id, appId),\n        eq(maintenanceApplications.emailOtp, otp),\n        gt(maintenanceApplications.emailOtpExpires, new Date())\n      ));\n    \n    if (app) {\n      await db.update(require(\"@shared/schema\").maintenanceApplications)\n        .set({ emailVerified: true })\n        .where(eq(require(\"@shared/schema\").maintenanceApplications.id, appId));\n      res.json({ success: true });\n    } else {\n      res.status(400).json({ message: \"Invalid OTP\" });\n    }\n  });\n\n  app.put(\"/api/maintenance/:id\", async (req, res) => {\n    const appId = Number(req.params.id);\n    const updates = req.body;\n    \n    const [updatedApp] = await db.update(maintenanceApplications)\n      .set({ ...updates, lastUpdated: new Date() })\n      .where(eq(maintenanceApplications.id, appId))\n      .returning();\n    \n    if (updates.status === \"submitted\") {\n      logActivity(\"Nueva Solicitud Mantenimiento\", {\n        \"Propietario\": updatedApp.ownerFullName,\n        \"LLC\": updatedApp.companyName,\n        \"EIN\": updatedApp.ein,\n        \"Estado\": updatedApp.state,\n        \"Email\": updatedApp.ownerEmail,\n        \"Disolver\": updatedApp.wantsDissolve || \"No\",\n        \"Servicios\": updatedApp.expectedServices\n      });\n    }\n    res.json(updatedApp);\n  });\n\n  // Seed Data\n  await seedDatabase();\n\n  // === Test Email Route ===\n  app.post(\"/api/admin/test-emails\", async (req, res) => {\n    const { email } = req.body;\n    if (!email) return res.status(400).json({ message: \"Email is required\" });\n\n    try {\n      const ticketId = \"12345678\";\n      const otp = \"888999\";\n      const name = \"Cliente de Prueba\";\n      const requestCode = \"NM-9999-ABC-0\";\n\n      // Improved Admin Activity Notification (Elegir Estado)\n      const activityHtml = `\n        <div style=\"background-color: #f9f9f9; padding: 20px 0;\">\n          <div style=\"font-family: 'Inter', Arial, sans-serif; max-width: 600px; margin: auto; border-radius: 8px; overflow: hidden; color: #1a1a1a; background-color: #ffffff; border: 1px solid #e5e5e5;\">\n            ${getEmailHeader()}\n            <div style=\"padding: 40px;\">\n              <h2 style=\"font-size: 18px; font-weight: 800; margin-bottom: 20px; color: #000;\">Log de Actividad: Selecci\u00F3n de Estado</h2>\n              <div style=\"background: #f4f4f4; border-left: 4px solid #000; padding: 20px; margin: 20px 0;\">\n                <p style=\"margin: 0 0 10px 0; font-size: 14px;\"><strong>Acci\u00F3n:</strong> Clic en bot\u00F3n elegir</p>\n                <p style=\"margin: 0 0 10px 0; font-size: 14px;\"><strong>Estado:</strong> New Mexico Pack</p>\n          <p style=\"margin: 0; font-size: 14px;\"><strong>Precio:</strong> 639\u20AC</p>\n        </div>\n        <p style=\"font-size: 12px; color: #999;\">IP Origen: 127.0.0.1 | Fecha: ${new Date().toLocaleString('es-ES', { timeZone: 'Europe/Madrid' })}</p>\n      </div>\n      ${getEmailFooter()}\n    </div>\n  </div>\n`;\n\n      // Admin Activity Notification Logic (production)\n      app.post(\"/api/activity/track\", async (req, res) => {\n        const { action, details } = req.body;\n        if (action === \"CLICK_ELEGIR_ESTADO\") {\n          let price = \"639\u20AC\";\n          if (details.includes(\"Wyoming\")) price = \"799\u20AC\";\n          if (details.includes(\"Delaware\")) price = \"999\u20AC\";\n          \n          logActivity(\"Selecci\u00F3n de Estado\", { \n            \"Pack\": details, \n            \"Precio Base\": price,\n            \"IP\": req.ip \n          });\n        }\n        res.json({ success: true });\n      });\nconst orderHtml = `\n  <div style=\"background-color: #f9f9f9; padding: 20px 0;\">\n    <div style=\"font-family: 'Inter', Arial, sans-serif; max-width: 600px; margin: auto; border-radius: 8px; overflow: hidden; color: #1a1a1a; background-color: #ffffff; border: 1px solid #e5e5e5;\">\n      ${getEmailHeader()}\n      <div style=\"padding: 40px;\">\n        <h2 style=\"font-size: 18px; font-weight: 800; margin-bottom: 20px; color: #000;\">Detalles de la Notificaci\u00F3n</h2>\n        <div style=\"margin-bottom: 25px;\">\n          <h3 style=\"font-size: 11px; text-transform: uppercase; color: #999; border-bottom: 1px solid #eee; padding-bottom: 5px; margin-bottom: 15px; font-weight: 800;\">Estado de la Transacci\u00F3n</h3>\n          <p style=\"margin: 0 0 8px 0; font-size: 14px;\"><strong>Estado Pago:</strong> <span style=\"color: #0d9488; font-weight: 700;\">CONFIRMADO (MOCK)</span></p>\n          <p style=\"margin: 0 0 8px 0; font-size: 14px;\"><strong>Fecha/Hora:</strong> ${new Date().toLocaleString('es-ES', { timeZone: 'Europe/Madrid' })}</p>\n          <p style=\"margin: 0; font-size: 14px;\"><strong>Aceptaci\u00F3n T\u00E9rminos:</strong> S\u00CD (Marcado en formulario)</p>\n        </div>\n\n        <div style=\"margin-bottom: 25px;\">\n          <h3 style=\"font-size: 11px; text-transform: uppercase; color: #999; border-bottom: 1px solid #eee; padding-bottom: 5px; margin-bottom: 15px; font-weight: 800;\">Informaci\u00F3n del Propietario</h3>\n          <p style=\"margin: 0 0 8px 0; font-size: 14px;\"><strong>Nombre:</strong> ${name}</p>\n          <p style=\"margin: 0 0 8px 0; font-size: 14px;\"><strong>DNI / Pasaporte:</strong> 12345678X (Test)</p>\n          <p style=\"margin: 0 0 8px 0; font-size: 14px;\"><strong>Email:</strong> ${email}</p>\n          <p style=\"margin: 0; font-size: 14px;\"><strong>Direcci\u00F3n:</strong> Calle Falsa 123, 28001 Madrid, Espa\u00F1a</p>\n        </div>\n\n        <div>\n          <h3 style=\"font-size: 11px; text-transform: uppercase; color: #999; border-bottom: 1px solid #eee; padding-bottom: 5px; margin-bottom: 15px; font-weight: 800;\">Detalles de la Empresa</h3>\n          <p style=\"margin: 0 0 8px 0; font-size: 14px;\"><strong>Nombre LLC:</strong> Mi Nueva Empresa LLC</p>\n          <p style=\"margin: 0 0 8px 0; font-size: 14px;\"><strong>Estado:</strong> New Mexico</p>\n          <p style=\"margin: 0 0 8px 0; font-size: 14px;\"><strong>Actividad:</strong> Consultor\u00EDa de Software y Marketing Digital</p>\n          <p style=\"margin: 0; font-size: 14px;\"><strong>Notas:</strong> Necesito el EIN urgente para abrir cuenta en Mercury.</p>\n        </div>\n      </div>\n      ${getEmailFooter()}\n    </div>\n  </div>\n`;\n\n      // Send improved admin templates\n      await Promise.all([\n        sendEmail({ to: email, subject: \"TEST: OTP Verificaci\u00F3n de Identidad\", html: getOtpEmailTemplate(otp) }),\n        sendEmail({ to: email, subject: \"TEST: Log de Actividad (Admin)\", html: activityHtml }),\n        sendEmail({ to: email, subject: \"TEST: Nueva Solicitud LLC (Admin)\", html: orderHtml }),\n        sendEmail({ to: email, subject: \"TEST: Confirmaci\u00F3n de Pedido (Cliente)\", html: getConfirmationEmailTemplate(name, requestCode, { companyName: \"Mi Nueva Empresa LLC\" }) }),\n        sendEmail({ to: email, subject: \"TEST: Bienvenido a Easy US LLC\", html: getWelcomeEmailTemplate(name) }),\n        sendEmail({ to: email, subject: \"TEST: Newsletter Bienvenida\", html: getNewsletterWelcomeTemplate() }),\n        sendEmail({ to: email, subject: \"TEST: Confirmaci\u00F3n de Mensaje (Auto-reply)\", html: getAutoReplyTemplate(ticketId, name) }),\n        sendEmail({ to: email, subject: \"TEST: OTP Mensaje de Contacto\", html: getOtpEmailTemplate(otp) }),\n      ]);\n\n      res.json({ success: true, message: \"Emails de prueba administrativos mejorados enviados\" });\n    } catch (error) {\n      console.error(\"Error sending test emails:\", error);\n      res.status(500).json({ message: \"Error al enviar emails de prueba\" });\n    }\n  });\n\n  return httpServer;\n}\n\nasync function seedDatabase() {\n  const existingProducts = await storage.getProducts();\n  if (existingProducts.length === 0) {\n    await storage.createProduct({\n      name: \"New Mexico LLC\",\n      description: \"Constituci\u00F3n r\u00E1pida en el estado m\u00E1s eficiente. Ideal para bajo coste de mantenimiento.\",\n      price: 63900,\n      features: [\n        \"Tasas del estado pagadas\",\n        \"Registered Agent (12 meses)\",\n        \"Articles of Organization oficiales\",\n        \"Operating Agreement profesional\",\n        \"EIN del IRS\",\n        \"BOI Report presentado\",\n        \"Declaraciones fiscales a\u00F1o 1\",\n        \"Soporte completo 12 meses\"\n      ],\n    });\n    await storage.createProduct({\n      name: \"Wyoming LLC\",\n      description: \"Constituci\u00F3n premium en el estado m\u00E1s prestigioso de USA. M\u00E1xima privacidad y protecci\u00F3n.\",\n      price: 79900,\n      features: [\n        \"Tasas del estado pagadas\",\n        \"Registered Agent (12 meses)\",\n        \"EIN del IRS garantizado\",\n        \"Articles of Organization oficiales\",\n        \"Operating Agreement profesional\",\n        \"BOI Report presentado\",\n        \"Annual Report a\u00F1o 1\",\n        \"Declaraciones fiscales a\u00F1o 1\",\n        \"Soporte completo 12 meses\"\n      ],\n    });\n    await storage.createProduct({\n      name: \"Delaware LLC\",\n      description: \"El est\u00E1ndar para startups y empresas tecnol\u00F3gicas. Reconocimiento legal global.\",\n      price: 99900,\n      features: [\n        \"Tasas del estado pagadas\",\n        \"Registered Agent (12 meses)\",\n        \"Articles of Organization oficiales\",\n        \"Operating Agreement profesional\",\n        \"EIN del IRS\",\n        \"BOI Report presentado\",\n        \"Declaraciones fiscales a\u00F1o 1\",\n        \"Soporte completo 12 meses\"\n      ],\n    });\n  }\n}\n", "import nodemailer from \"nodemailer\";\n\nexport function getEmailHeader(title: string = \"Easy US LLC\") {\n  const domain = \"easyusllc.com\";\n  const protocol = 'https';\n  const logoUrl = `${protocol}://${domain}/logo-email.png?v=4`;\n  \n  return `\n    <div style=\"background-color: #ffffff; padding: 40px 20px; text-align: center; border-bottom: 2px solid #6EDC8A;\">\n      <div style=\"margin-bottom: 20px; display: block; width: 100%; text-align: center;\">\n        <a href=\"https://${domain}\" target=\"_blank\" style=\"text-decoration: none; display: inline-block;\">\n          <img src=\"${logoUrl}\" alt=\"Easy US LLC\" width=\"100\" height=\"100\" style=\"display: inline-block; margin: 0 auto; width: 100px; height: 100px; object-fit: contain; border: 0;\" />\n        </a>\n      </div>\n      <h1 style=\"color: #0E1215; margin: 0; font-family: 'Inter', Arial, sans-serif; font-weight: 900; text-transform: uppercase; letter-spacing: -1px; font-size: 24px; line-height: 1;\">\n        ${title}\n      </h1>\n    </div>\n  `;\n}\n\nexport function getEmailFooter() {\n  const year = new Date().getFullYear();\n  return `\n    <div style=\"background-color: #0E1215; padding: 40px 20px; text-align: center; color: #F7F7F5; font-family: 'Inter', Arial, sans-serif;\">\n      <p style=\"margin: 0 0 15px 0; font-weight: 800; color: #6EDC8A; text-transform: uppercase; font-size: 12px; letter-spacing: 1px;\">Expertos en formaci\u00F3n de LLC</p>\n      <p style=\"margin: 0; font-size: 13px; color: #F7F7F5; font-weight: 500;\">New Mexico, USA | <a href=\"mailto:info@easyusllc.com\" style=\"color: #6EDC8A; text-decoration: none; font-weight: 700;\">info@easyusllc.com</a></p>\n      <div style=\"margin-top: 20px;\">\n        <a href=\"https://wa.me/34614916910\" style=\"color: #F7F7F5; text-decoration: none; font-weight: 800; font-size: 11px; text-transform: uppercase; margin: 0 15px; border-bottom: 1px solid #6EDC8A;\">WhatsApp</a>\n        <a href=\"https://easyusllc.com\" style=\"color: #F7F7F5; text-decoration: none; font-weight: 800; font-size: 11px; text-transform: uppercase; margin: 0 15px; border-bottom: 1px solid #6EDC8A;\">Web Oficial</a>\n      </div>\n      <p style=\"margin-top: 30px; font-size: 10px; color: #6B7280; text-transform: uppercase; letter-spacing: 1px;\">\u00A9 ${year} Easy US LLC. Todos los derechos reservados.</p>\n    </div>\n  `;\n}\n\nexport function getAutoReplyTemplate(ticketId: string, name: string = \"Cliente\") {\n  return `\n    <div style=\"background-color: #f9f9f9; padding: 20px 0;\">\n      <div style=\"font-family: 'Inter', Arial, sans-serif; max-width: 600px; margin: auto; border-radius: 8px; overflow: hidden; color: #1a1a1a; background-color: #ffffff; border: 1px solid #e5e5e5;\">\n        ${getEmailHeader()}\n        <div style=\"padding: 40px;\">\n          <h2 style=\"font-size: 20px; font-weight: 800; margin-bottom: 20px; color: #000;\">Hemos recibido tu consulta</h2>\n          <p style=\"line-height: 1.6; font-size: 15px; color: #444; margin-bottom: 25px;\">Hola <strong>${name}</strong>, gracias por contactar con Easy US LLC. Tu consulta ha sido registrada correctamente con el identificador que ver\u00E1s a continuaci\u00F3n.</p>\n          \n          <div style=\"background: #f4f4f4; padding: 20px; border-radius: 8px; margin: 25px 0; border: 1px solid #6EDC8A; text-align: center;\">\n            <p style=\"margin: 0; font-size: 12px; color: #6B7280; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 5px;\">Referencia de Seguimiento</p>\n            <p style=\"margin: 0; font-size: 24px; font-weight: 900; color: #0E1215;\">#${ticketId}</p>\n          </div>\n\n          <p style=\"line-height: 1.6; font-size: 15px; color: #444; margin-bottom: 20px;\">Nuestro equipo de expertos revisar\u00E1 tu mensaje y te responder\u00E1 de forma personalizada en un plazo de <strong>24 a 48 horas h\u00E1biles</strong>.</p>\n          \n          <p style=\"line-height: 1.6; font-size: 14px; color: #6B7280;\">Si necesitas a\u00F1adir informaci\u00F3n adicional, simplemente responde a este correo manteniendo el asunto intacto.</p>\n        </div>\n        ${getEmailFooter()}\n      </div>\n    </div>\n  `;\n}\n\nexport function getOtpEmailTemplate(otp: string) {\n  return `\n    <div style=\"background-color: #F7F7F5; padding: 20px 0;\">\n      <div style=\"font-family: 'Inter', Arial, sans-serif; max-width: 600px; margin: auto; border-radius: 8px; overflow: hidden; color: #0E1215; background-color: #ffffff; border: 1px solid #E6E9EC;\">\n        ${getEmailHeader()}\n        <div style=\"padding: 40px;\">\n          <h2 style=\"font-size: 20px; font-weight: 800; margin-bottom: 20px; color: #0E1215;\">Verificaci\u00F3n de Identidad</h2>\n          <p style=\"line-height: 1.6; font-size: 15px; color: #0E1215; margin-bottom: 25px;\">Verifica tu email con el siguiente c\u00F3digo de seguridad:</p>\n          \n          <div style=\"background: #F7F7F5; padding: 25px; border-radius: 8px; margin: 25px 0; text-align: center; border: 2px solid #6EDC8A;\">\n            <p style=\"margin: 0; font-size: 32px; font-weight: 900; color: #0E1215; letter-spacing: 8px;\">${otp}</p>\n          </div>\n\n          <p style=\"line-height: 1.6; font-size: 12px; color: #6B7280; margin-top: 20px;\">Este c\u00F3digo caducar\u00E1 en 10 minutos.</p>\n        </div>\n        ${getEmailFooter()}\n      </div>\n    </div>\n  `;\n}\n\nexport function getWelcomeEmailTemplate(name: string) {\n  return `\n    <div style=\"background-color: #f9f9f9; padding: 20px 0;\">\n      <div style=\"font-family: 'Inter', Arial, sans-serif; max-width: 600px; margin: auto; border-radius: 8px; overflow: hidden; color: #1a1a1a; background-color: #ffffff; border: 1px solid #e5e5e5;\">\n        ${getEmailHeader()}\n        <div style=\"padding: 40px;\">\n          <h2 style=\"font-size: 20px; font-weight: 800; margin-bottom: 20px; color: #000;\">Bienvenido a Easy US LLC, ${name}</h2>\n          <p style=\"line-height: 1.6; font-size: 15px; color: #444; margin-bottom: 20px;\">Es un placer acompa\u00F1arte en la expansi\u00F3n de tu negocio hacia los Estados Unidos. Nuestra misi\u00F3n es simplificar cada paso administrativo para que t\u00FA puedas centrarte en crecer.</p>\n          \n          <div style=\"background: #fcfcfc; border-left: 3px solid #000; padding: 20px; margin: 25px 0;\">\n            <p style=\"margin: 0; font-size: 15px; font-weight: 700; color: #000;\">\u00BFQu\u00E9 esperar ahora?</p>\n            <ul style=\"margin: 15px 0 0 0; padding-left: 20px; color: #555; font-size: 14px; line-height: 1.6;\">\n              <li style=\"margin-bottom: 8px;\">Asignaci\u00F3n de un agente especializado a tu expediente.</li>\n              <li style=\"margin-bottom: 8px;\">Revisi\u00F3n de disponibilidad de nombres en el estado seleccionado.</li>\n              <li style=\"margin-bottom: 8px;\">Preparaci\u00F3n de documentos constitutivos oficiales.</li>\n            </ul>\n          </div>\n\n          <p style=\"line-height: 1.6; font-size: 14px; color: #666;\">Recibir\u00E1s actualizaciones peri\u00F3dicas sobre el estado de tu formaci\u00F3n. Si tienes cualquier consulta, nuestro equipo est\u00E1 a tu disposici\u00F3n v\u00EDa WhatsApp o email.</p>\n        </div>\n        ${getEmailFooter()}\n      </div>\n    </div>\n  `;\n}\n\nexport function getConfirmationEmailTemplate(name: string, requestCode: string, details?: any) {\n  const now = new Date();\n  const dateStr = now.toLocaleDateString('es-ES', { timeZone: 'Europe/Madrid' });\n  const timeStr = now.toLocaleTimeString('es-ES', { timeZone: 'Europe/Madrid', hour: '2-digit', minute: '2-digit' });\n\n  return `\n    <div style=\"background-color: #f9f9f9; padding: 20px 0;\">\n      <div style=\"font-family: 'Inter', Arial, sans-serif; max-width: 600px; margin: auto; border-radius: 8px; overflow: hidden; color: #1a1a1a; background-color: #ffffff; border: 1px solid #e5e5e5;\">\n        ${getEmailHeader()}\n        <div style=\"padding: 40px;\">\n          <h2 style=\"font-size: 20px; font-weight: 800; margin-bottom: 20px; color: #000;\">\u00A1Gracias por tu solicitud, ${name}!</h2>\n          <p style=\"line-height: 1.6; font-size: 15px; color: #444; margin-bottom: 25px;\">Hemos recibido correctamente los datos para el registro de tu nueva LLC. Nuestro equipo de especialistas comenzar\u00E1 con la revisi\u00F3n t\u00E9cnica de inmediato.</p>\n          \n          <div style=\"background: #fcfcfc; padding: 25px; border-radius: 8px; margin: 25px 0; border: 1px solid #6EDC8A;\">\n            <p style=\"margin: 0 0 15px 0; font-size: 12px; font-weight: 800; text-transform: uppercase; color: #6B7280; letter-spacing: 1px;\">Referencia de Solicitud</p>\n            <p style=\"margin: 0; font-size: 24px; font-weight: 900; color: #0E1215;\">${requestCode}</p>\n          </div>\n\n          <div style=\"margin-bottom: 25px;\">\n            <h3 style=\"margin: 0 0 15px 0; font-size: 13px; font-weight: 800; text-transform: uppercase; color: #000; border-bottom: 1px solid #f0f0f0; padding-bottom: 8px;\">Resumen del Registro</h3>\n            <table style=\"width: 100%; font-size: 14px; border-collapse: collapse;\">\n              <tr>\n                <td style=\"padding: 8px 0; color: #666;\">Fecha y hora:</td>\n                <td style=\"padding: 8px 0; font-weight: 700; text-align: right;\">${dateStr} | ${timeStr}</td>\n              </tr>\n              <tr>\n                <td style=\"padding: 8px 0; color: #666;\">Nombre Propuesto:</td>\n                <td style=\"padding: 8px 0; font-weight: 700; text-align: right;\">${details?.companyName || 'Pendiente'}</td>\n              </tr>\n              <tr>\n                <td style=\"padding: 8px 0; color: #666;\">Estado de Pago:</td>\n                <td style=\"padding: 8px 0; font-weight: 700; text-align: right; color: #0d9488;\">Confirmado / Procesando</td>\n              </tr>\n            </table>\n          </div>\n\n          <div style=\"background: #FFF9E6; padding: 20px; border-radius: 8px; border: 1px solid #FFE4B3; margin: 25px 0;\">\n            <p style=\"margin: 0; font-size: 14px; color: #856404; line-height: 1.6;\"><strong>Pr\u00F3ximos Pasos:</strong> En las pr\u00F3ximas 24-48h recibir\u00E1s un email con los documentos constitutivos para tu firma electr\u00F3nica. Por favor, mantente atento a tu bandeja de entrada.</p>\n          </div>\n\n          <p style=\"line-height: 1.6; font-size: 14px; color: #666;\">Si necesitas realizar cualquier cambio en los datos suministrados, por favor contacta con nosotros respondiendo a este correo.</p>\n        </div>\n        ${getEmailFooter()}\n      </div>\n    </div>\n  `;\n}\n\nexport function getNewsletterWelcomeTemplate() {\n  return `\n    <div style=\"background-color: #f9f9f9; padding: 20px 0;\">\n      <div style=\"font-family: 'Inter', Arial, sans-serif; max-width: 600px; margin: auto; border-radius: 8px; overflow: hidden; color: #1a1a1a; background-color: #ffffff; border: 1px solid #e5e5e5;\">\n        ${getEmailHeader()}\n        <div style=\"padding: 40px;\">\n          <h2 style=\"font-size: 20px; font-weight: 800; margin-bottom: 20px; color: #000;\">Suscripci\u00F3n Confirmada</h2>\n          <p style=\"line-height: 1.6; font-size: 15px; color: #444; margin-bottom: 25px;\">Ya formas parte de la comunidad de Easy US LLC. A partir de ahora, recibir\u00E1s informaci\u00F3n estrat\u00E9gica para optimizar tu negocio en EE.UU.</p>\n          \n          <div style=\"background: #fcfcfc; padding: 25px; border-radius: 8px; border: 1px solid #eee;\">\n            <p style=\"margin: 0 0 15px 0; font-weight: 800; font-size: 12px; text-transform: uppercase; color: #000;\">Lo que vas a recibir:</p>\n            <div style=\"margin-bottom: 15px;\">\n              <p style=\"margin: 0; font-weight: 700; font-size: 14px; color: #000;\">Gu\u00EDas de Cumplimiento</p>\n              <p style=\"margin: 3px 0 0 0; font-size: 13px; color: #666;\">Informaci\u00F3n clave sobre BOI Reports y declaraciones anuales.</p>\n            </div>\n            <div style=\"margin-bottom: 15px;\">\n              <p style=\"margin: 0; font-weight: 700; font-size: 14px; color: #000;\">Tips de Banca USA</p>\n              <p style=\"margin: 3px 0 0 0; font-size: 13px; color: #666;\">Novedades sobre Mercury, Relay y gesti\u00F3n de fondos en USD.</p>\n            </div>\n            <div>\n              <p style=\"margin: 0; font-weight: 700; font-size: 14px; color: #000;\">Estrategia Fiscal</p>\n              <p style=\"margin: 3px 0 0 0; font-size: 13px; color: #666;\">C\u00F3mo operar sin IVA y minimizar el impacto tributario legalmente.</p>\n            </div>\n          </div>\n\n          <p style=\"line-height: 1.6; font-size: 14px; color: #666; margin-top: 25px; text-align: center;\">Bienvenido al ecosistema global de emprendimiento.</p>\n        </div>\n        ${getEmailFooter()}\n      </div>\n    </div>\n  `;\n}\n\nexport function getReminderEmailTemplate(name: string, requestCode: string) {\n  return `\n    <div style=\"background-color: #f9f9f9; padding: 20px 0;\">\n      <div style=\"font-family: 'Inter', Arial, sans-serif; max-width: 600px; margin: auto; border-radius: 8px; overflow: hidden; color: #1a1a1a; background-color: #ffffff; border: 1px solid #e5e5e5;\">\n        ${getEmailHeader()}\n        <div style=\"padding: 40px;\">\n          <h2 style=\"font-size: 20px; font-weight: 800; margin-bottom: 20px; color: #000;\">Termina tu registro</h2>\n          <p style=\"line-height: 1.6; font-size: 15px; color: #444;\">Hola <strong>${name}</strong>, hemos notado que tu solicitud para una nueva LLC a\u00FAn no est\u00E1 completa.</p>\n          \n          <div style=\"background: #f1f5f9; padding: 25px; border-radius: 8px; margin: 35px 0; border: 1px dashed #cbd5e1; text-align: center;\">\n            <p style=\"margin: 0; font-size: 15px; color: #000;\"><strong>Solicitud pendiente:</strong> ${requestCode}</p>\n          </div>\n\n          <div style=\"text-align: center; margin-top: 30px;\">\n            <a href=\"https://easyusllc.com/seguimiento\" style=\"background-color: #000; color: #fff; padding: 15px 35px; text-decoration: none; border-radius: 6px; font-weight: 800; display: inline-block; text-transform: uppercase; font-size: 13px; letter-spacing: 1px;\">Continuar Solicitud \u2192</a>\n          </div>\n        </div>\n        ${getEmailFooter()}\n      </div>\n    </div>\n  `;\n}\n\nconst transporter = nodemailer.createTransport({\n  host: process.env.SMTP_HOST || \"smtp.ionos.es\",\n  port: parseInt(process.env.SMTP_PORT || \"587\"),\n  secure: false, // TLS\n  auth: {\n    user: process.env.SMTP_USER,\n    pass: process.env.SMTP_PASS,\n  },\n  tls: {\n    // do not fail on invalid certs\n    rejectUnauthorized: false\n  },\n  pool: true,\n  maxConnections: 5,\n  maxMessages: 100,\n});\n\nexport async function sendEmail({ to, subject, html }: { to: string; subject: string; html: string }) {\n  if (!process.env.SMTP_USER || !process.env.SMTP_PASS) {\n    console.warn(\"Email credentials missing. Email not sent.\");\n    return;\n  }\n\n  try {\n    const info = await transporter.sendMail({\n      from: `\"Easy US LLC\" <${process.env.SMTP_USER}>`,\n      to,\n      subject,\n      html,\n    });\n    console.log(\"Email sent: %s\", info.messageId);\n    return info;\n  } catch (error) {\n    console.error(\"Error sending email:\", error);\n    throw error;\n  }\n}\n", "import express, { type Express } from \"express\";\nimport fs from \"fs\";\nimport path from \"path\";\n\nexport function serveStatic(app: Express) {\n  const distPath = path.resolve(__dirname, \"public\");\n  if (!fs.existsSync(distPath)) {\n    throw new Error(\n      `Could not find the build directory: ${distPath}, make sure to build the client first`,\n    );\n  }\n\n  app.use(express.static(distPath, {\n    maxAge: '1y',\n    immutable: true,\n    index: false,\n    etag: true,\n    lastModified: true\n  }));\n\n  // fall through to index.html if the file doesn't exist\n  app.use(\"*\", (_req, res) => {\n    res.sendFile(path.resolve(distPath, \"index.html\"), {\n      headers: {\n        'Cache-Control': 'no-cache, no-store, must-revalidate'\n      }\n    });\n  });\n}\n"],
  "mappings": "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",
  "names": ["newsletterSubscribers", "import_pg_core", "import_drizzle_orm", "import_path", "react", "path", "pool", "crypto", "app", "createViteServer", "path", "import_meta", "fs", "import_vite", "import_fs", "import_path", "import_express", "import_passport", "pg", "import_drizzle_orm", "memoize", "connectPg", "session", "app", "passport", "app", "import_drizzle_orm", "app", "newsletterSubscribers", "import_zod", "nodemailer", "import_drizzle_orm", "httpServer", "app", "products", "orders", "timestamp", "users", "req", "res", "app", "path", "fs", "express", "express", "compression", "setupVite"]
}
